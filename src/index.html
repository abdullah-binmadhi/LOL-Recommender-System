<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>League of Legends Champion Recommender System</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23667eea'><path d='M15 5.1L9 3 3 5.02v16.2l6-2.33 6 2.1 6-2.02V2.77L15 5.1zm0 13.79l-6-2.11V5.11l6 2.11v11.67z'/></svg>" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #3E1E68 0%, #5D2F77 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 0;
            margin: 30px auto;
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
            display: none;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 1000px;
            width: 100%;
        }

        .card.active {
            display: block;
            animation: fadeIn 0.7s cubic-bezier(0.19, 1, 0.22, 1);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        .start-screen {
            display: block;
            background: linear-gradient(135deg, #3E1E68 0%, #5D2F77 100%);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .feature {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .feature-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-primary {
            background: linear-gradient(135deg, #3E1E68, #5D2F77);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #5D2F77, #3E1E68);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .btn-secondary {
            background: rgba(108, 117, 125, 0.8);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .btn-secondary:hover {
            background: rgba(108, 117, 125, 1);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .btn-large {
            padding: 15px 30px;
            font-size: 18px;
        }

        .question h2 {
            margin-bottom: 20px;
            color: white;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
            font-size: 1.5rem;
            padding: 25px 25px 0 25px;
            text-align: center;
            font-weight: 600;
        }

        .options {
            display: grid;
            gap: 15px;
            margin: 20px 25px;
            padding-bottom: 10px;
        }

        .option {
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            text-align: left;
        }

        .option:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .option.selected {
            background: #3E1E68;
            color: white;
            border-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .progress-container {
            margin-bottom: 10px;
            padding: 25px 25px 0 25px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: 600;
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .progress-bar {
            height: 8px;
            background: rgba(233, 236, 239, 0.3);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.5s ease;
        }

        .buttons {
            display: flex;
            justify-content: center;
            margin: 20px 25px 25px;
            padding-bottom: 10px;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            min-width: 300px;
            justify-content: space-between;
        }
        
        .btn-spacer {
            width: 100px;
        }

        .champion-count {
            text-align: center;
            color: white;
            margin-bottom: 20px;
            font-size: 1.1rem;
        }

        .champion-image {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid #667eea;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .champion-image-large {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid #667eea;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .champion-name {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .champion-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
            padding: 15px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 8px;
        }

        .stat-item {
            text-align: center;
            padding: 8px;
            background: white;
            border-radius: 6px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #666;
            margin-top: 3px;
        }

        .tier-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-weight: bold;
            font-size: 0.8rem;
            margin: 5px 0;
        }

        .tier-S { background: #ff6b6b; color: white; }
        .tier-A { background: #4ecdc4; color: white; }
        .tier-B { background: #45b7d1; color: white; }
        .tier-C { background: #96ceb4; color: white; }
        .tier-D { background: #feca57; color: white; }

        .trend-indicator {
            display: inline-block;
            margin-left: 5px;
        }

        .champion-role {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .confidence-score {
            background: #e8f4f8;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
        }

        .confidence-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: #20c997;
        }

        .ml-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .stat-item {
            background: white;
            padding: 8px;
            border-radius: 5px;
            text-align: center;
            font-size: 0.9rem;
        }

        .stat-label {
            color: #666;
            font-size: 0.8rem;
        }

        .stat-value {
            font-weight: bold;
            color: #333;
        }

        /* Enhanced Detailed Analysis Styles */
        .analysis-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }

        .analysis-header h2 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .analysis-header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .algorithm-analysis {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .algorithm-analysis:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .algorithm-analysis.winner {
            border-color: #28a745;
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
        }

        .algorithm-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .algorithm-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .algorithm-title h3 {
            color: #667eea;
            font-size: 1.4rem;
            margin: 0;
        }

        .algorithm-icon {
            font-size: 1.8rem;
        }

        .winner-crown {
            background: #28a745;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .champion-result {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            text-align: center;
        }

        .champion-result .champion-name {
            font-size: 1.8rem;
            color: #333;
            margin-bottom: 8px;
        }

        .champion-result .champion-role {
            font-size: 1rem;
            margin-bottom: 15px;
        }

        .confidence-display {
            background: linear-gradient(135deg, #20c997, #17a2b8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .confidence-display .confidence-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .confidence-display .confidence-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .algorithm-details {
            margin: 20px 0;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .detail-item:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-weight: 600;
            color: #495057;
        }

        .detail-value {
            color: #28a745;
            font-weight: bold;
        }

        .performance-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .performance-section h3 {
            color: #495057;
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.6rem;
        }

        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .performance-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .performance-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .performance-metric {
            font-size: 1.5rem;
            font-weight: bold;
            color: #28a745;
            margin-bottom: 5px;
        }

        .performance-description {
            font-size: 0.9rem;
            color: #6c757d;
        }

        /* Champion Analysis Section Styles */
        .champion-analysis-section {
            background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .champion-analysis-section h3 {
            color: #e65100;
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.6rem;
        }

        .analysis-explanation {
            text-align: center;
            margin-bottom: 30px;
        }

        .analysis-explanation p {
            color: #bf360c;
            font-size: 1.1rem;
            font-weight: 500;
        }

        .match-analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
        }
        
        .match-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-top: 4px solid #ff9800;
        }

        .match-card.winner {
            border: 2px solid #28a745;
            background: linear-gradient(135deg, #f8f9fa 0%, #e6f7ef 100%);
        }
        
        .winner-badge {
            display: inline-block;
            background: #28a745;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-left: 8px;
            vertical-align: middle;
        }
        
        .algorithm-info {
            font-size: 0.85rem;
            color: #6c757d;
            margin-top: 3px;
        }
        
        .champion-stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin: 15px 0;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 8px;
            padding: 10px;
        }
        
        .champion-stats-grid .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: white;
            padding: 8px;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .champion-stats-grid .stat-label {
            font-size: 0.75rem;
            color: #6c757d;
        }
        
        .champion-stats-grid .stat-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: #667eea;
        }

        .match-analysis-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-top: 4px solid #ff9800;
        }

        .match-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .match-champion-img {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 3px solid #ff9800;
        }

        .match-info h4 {
            color: #e65100;
            margin: 0;
            font-size: 1.2rem;
        }

        .match-tier {
            color: #757575;
            font-size: 0.9rem;
        }

        .compatibility-score {
            background: linear-gradient(135deg, #ff9800, #ffc107);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
        }

        .score-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .score-value {
            font-size: 2rem;
            font-weight: bold;
        }

        .match-breakdown {
            margin-bottom: 20px;
        }

        .breakdown-item {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 12px;
        }

        .breakdown-label {
            flex: 0 0 100px;
            font-size: 0.9rem;
            color: #424242;
            font-weight: 500;
        }

        .breakdown-bar {
            flex: 1;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }

        .breakdown-fill {
            height: 100%;
            background: linear-gradient(90deg, #4caf50, #8bc34a);
            transition: width 0.5s ease;
        }

        .breakdown-value {
            flex: 0 0 40px;
            text-align: right;
            font-size: 0.8rem;
            font-weight: 600;
            color: #2e7d32;
        }

        .champion-highlights {
            border-top: 1px solid #e0e0e0;
            padding-top: 15px;
        }

        .highlight-title {
            color: #424242;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .highlight-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .highlight-tag {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .highlight-tag.damage { background: #ffebee; color: #c62828; }
        .highlight-tag.tank { background: #e8f5e8; color: #2e7d32; }
        .highlight-tag.mobile { background: #e3f2fd; color: #1565c0; }
        .highlight-tag.control { background: #f3e5f5; color: #7b1fa2; }
        .highlight-tag.utility { background: #fff3e0; color: #ef6c00; }
        .highlight-tag.easy { background: #e0f2f1; color: #00695c; }

        /* Recommendations Section Styles */
        .recommendations-section {
            background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .recommendations-section h3 {
            color: #4a148c;
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.6rem;
        }

        .recommendation-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .recommendation-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .primary-rec {
            border-top: 4px solid #9c27b0;
        }

        .counter-synergies {
            border-top: 4px solid #673ab7;
        }

        .alternative-picks {
            border-top: 4px solid #3f51b5;
        }

        .meta-insights {
            border-top: 4px solid #2196f3;
        }

        .rec-icon {
            font-size: 2rem;
            text-align: center;
            margin-bottom: 15px;
        }

        .recommendation-card h4 {
            color: #4a148c;
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .primary-champion {
            font-size: 1.5rem;
            font-weight: bold;
            color: #7b1fa2;
            text-align: center;
            margin-bottom: 15px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .action-btn {
            flex: 1;
            padding: 8px 12px;
            background: #9c27b0;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: background 0.3s;
        }

        .action-btn:hover {
            background: #7b1fa2;
        }

        .matchup-list {
            margin-bottom: 15px;
        }

        .matchup-category {
            font-weight: 600;
            color: #212121;
            margin: 12px 0 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.05rem;
        }

        .matchup-icon {
            color: #673ab7;
            font-size: 1.1rem;
        }

        .matchup-item {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #f5f5f5;
            padding: 8px 12px;
            border-radius: 6px;
            margin-bottom: 8px;
            color: #333333;
            font-weight: 500;
        }

        .strong-against {
            border-left: 3px solid #4caf50;
            background-color: rgba(76, 175, 80, 0.12);
        }

        .weak-against {
            border-left: 3px solid #f44336;
            background-color: rgba(244, 67, 54, 0.12);
        }

        .synergizes-with {
            border-left: 3px solid #2196f3;
            background-color: rgba(33, 150, 243, 0.12);
        }

        .alternatives-list {
            space-y: 10px;
        }

        .alternative-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
        }

        .alt-champion-img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #3f51b5;
        }

        .alt-name {
            font-weight: 600;
            color: #1a237e;
        }

        .alt-reason {
            font-size: 0.8rem;
            color: #666;
        }

        .meta-info {
            space-y: 12px;
        }

        .meta-stat {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .meta-label {
            color: #424242;
            font-size: 0.9rem;
        }

        .meta-value {
            font-weight: bold;
            color: #1565c0;
        }

        .meta-recommendation {
            background: #e3f2fd;
            padding: 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: #0d47a1;
            margin-top: 12px;
        }

        .final-tips {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .final-tips h4 {
            color: #4a148c;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .tips-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .tip-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 15px;
            background: #fafafa;
            border-radius: 10px;
        }

        .tip-icon {
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .tip-text {
            color: #424242;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .champion-tip-source {
            margin-top: 15px;
            text-align: center;
            padding: 12px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 8px;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .champion-tip-source small {
            color: #4a148c;
            font-style: italic;
            font-weight: 500;
        }

        .strategy-section {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .strategy-section h3 {
            color: #856404;
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.6rem;
        }

        .preference-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .preference-item {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .preference-item h4 {
            color: #856404;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .preference-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #495057;
            margin-bottom: 8px;
        }

        .preference-description {
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.4;
        }

        .comparison-table {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .comparison-table h3 {
            color: #495057;
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.6rem;
        }

        .table-responsive {
            overflow-x: auto;
        }

        .comparison-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
        }

        .comparison-table th {
            background: #f8f9fa;
            color: #495057;
            font-weight: 600;
        }

        .comparison-table td {
            color: #6c757d;
        }

        .table-winner {
            background: #d4edda !important;
            color: #155724 !important;
            font-weight: bold;
        }

        /* Enhanced Start Screen Styles */
        .hero-section {
            text-align: center;
            padding: 40px 25px;
            color: white;
            margin-bottom: 30px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.9) 0%, rgba(118, 75, 162, 0.9) 100%);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect width="100" height="100" fill="none" /><path d="M30,20 L70,20 L50,50 Z" fill="rgba(255,255,255,0.05)" /><circle cx="70" cy="70" r="10" fill="rgba(255,255,255,0.05)" /></svg>');
            background-size: 180px;
            opacity: 0.3;
            z-index: 0;
        }

        .hero-content {
            position: relative;
            z-index: 1;
            margin-bottom: 40px;
        }

        .hero-title {
            font-size: 2.6rem;
            font-weight: 800;
            margin-bottom: 20px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            background: linear-gradient(to right, #fff, #e0e0ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero-description {
            font-size: 1.2rem;
            opacity: 0.95;
            max-width: 650px;
            margin: 0 auto 30px;
            line-height: 1.7;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin: 40px 0;
            position: relative;
            z-index: 1;
        }

        .feature {
            text-align: center;
            padding: 30px 20px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            position: relative;
        }

        .feature::before {
            content: '';
            position: absolute;
            top: -10%;
            left: -10%;
            width: 120%;
            height: 120%;
            background: radial-gradient(circle at center, rgba(255,255,255,0.2) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .feature:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-5px) scale(1.03);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }

        .feature:hover::before {
            opacity: 1;
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            display: block;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .feature h3 {
            color: white;
            margin-bottom: 12px;
            font-size: 1.3rem;
            font-weight: 700;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .feature p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
            line-height: 1.6;
        }

        .cta-section {
            text-align: center;
            margin: 40px 0 20px;
            position: relative;
            z-index: 1;
        }

        .btn-hero {
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%);
            color: #4a3650;
            border: none;
            padding: 18px 40px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: inline-flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.25);
            position: relative;
            overflow: hidden;
        }

        .btn-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.7s;
        }

        .btn-hero:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.3);
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        }

        .btn-hero:hover::before {
            left: 100%;
        }

        .btn-text {
            font-weight: 700;
            position: relative;
            z-index: 1;
        }

        .btn-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
            position: relative;
            z-index: 1;
        }

        .btn-hero:hover .btn-icon {
            transform: translateX(5px);
        }

        /* Simplified User Registration Form Styles */
        .user-registration {
            max-width: 500px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        .registration-header {
            text-align: center;
            margin-bottom: 25px;
            padding-top: 25px;
            color: white;
        }

        .registration-header h2 {
            color: white;
            font-size: 1.8rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .registration-header p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .registration-form {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin: 0 25px 25px 25px;
        }

        .form-group {
            position: relative;
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            color: white;
            margin-bottom: 8px;
            font-size: 0.9rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 45px 12px 12px;
            border: 1px solid #e9ecef;
        }

        .form-group input:focus,
        .form-group select:focus {
            border-color: #80bdff;
            outline: 0;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
        }

        .form-group .input-icon {
            position: absolute;
            top: 50%;
            right: 15px;
            transform: translateY(-50%);
            color: #6c757d;
        }

        .form-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .form-buttons .btn {
            flex: 1;
        }
        
        /* Enhanced for ML Analysis Section */
        .detailed-analysis {
            background: rgba(255, 255, 255, 0.15) !important;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .detailed-analysis h2 {
            color: white;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            padding: 25px 25px 0 25px;
            font-size: 1.8rem;
        }
        
        /* Enhanced styling for analysis content */
        #analysis-content {
            padding: 0 25px 25px 25px;
            color: white;
        }
        
        /* Question Card Specific Styling */
        .question-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
            overflow: hidden;
        }
        
        #questions-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 45px 12px 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(5px);
            color: white;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.5);
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2);
        }

        .form-icon {
            position: absolute;
            right: 12px;
            top: 38px;
            font-size: 1rem;
            pointer-events: none;
        }

        .form-buttons {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-top: 10px;
        }

        .form-buttons .btn {
            flex: 1;
        }

        /* Responsive design for mobile */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.2rem;
            }
            
            .hero-stats {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            .stat-bubble {
                min-width: 80px;
                padding: 15px;
            }
            
            .algorithm-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .btn-hero {
                padding: 18px 35px;
                font-size: 1.1rem;
            }

            .registration-form {
                padding: 25px;
            }

            .form-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .form-buttons {
                flex-direction: column;
            }

            .form-buttons .btn {
                max-width: none;
            }
        }

        /* Champion Showcase Styles */
        .champion-showcase {
            position: relative;
            z-index: 1;
            margin: 20px auto 40px;
        }

        .champion-images {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .champion-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid rgba(255, 255, 255, 0.7);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            transform: scale(1);
            filter: brightness(0.9);
            animation: pulse 3s infinite alternate ease-in-out;
        }

        .champion-avatar:nth-child(2) {
            animation-delay: 0.6s;
        }

        .champion-avatar:nth-child(3) {
            animation-delay: 1.2s;
        }

        .champion-avatar:nth-child(4) {
            animation-delay: 1.8s;
        }

        .champion-avatar:nth-child(5) {
            animation-delay: 2.4s;
        }

        .champion-avatar:hover {
            transform: scale(1.15) translateY(-10px);
            border-color: #fff;
            filter: brightness(1.1);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
            z-index: 2;
        }

        @keyframes pulse {
            0% {
                transform: scale(1) translateY(0);
            }
            100% {
                transform: scale(1.1) translateY(-5px);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Enhanced header */
        .header h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            background: linear-gradient(to right, #fff, #e0e0ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.95;
            color: white;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        /* Animation enhancements */
        .start-screen {
            animation: fadeIn 1s ease-in-out;
        }

        /* Enhanced background */
        body {
            background-image: linear-gradient(135deg, #667eea 0%, #764ba2 100%), 
                              url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect width="100" height="100" fill="none" /><path d="M30,20 L70,20 L50,50 Z" fill="rgba(255,255,255,0.03)" /></svg>');
            background-blend-mode: overlay;
            background-size: cover, 300px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="league-icon"></i> League of Legends Champion Recommender</h1>
            <p>Discover your perfect champion match with AI-powered recommendations</p>
        </div>

        <!-- Start Screen -->
        <div id="start-screen" class="card start-screen">
            <div class="hero-section">
                <div class="hero-content">
                    <h1 class="hero-title"><i class="champion-finder-icon"></i> Find Your Perfect Champion</h1>
                    <p class="hero-description">Our AI-powered system analyzes your playstyle preferences to find the ideal League of Legends champion that matches exactly what you're looking for</p>
                </div>
                
                <div class="champion-showcase">
                    <div class="champion-images">
                        <img src="https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Jinx.png" alt="Jinx" class="champion-avatar">
                        <img src="https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Yasuo.png" alt="Yasuo" class="champion-avatar">
                        <img src="https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Ahri.png" alt="Ahri" class="champion-avatar">
                        <img src="https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Zed.png" alt="Zed" class="champion-avatar">
                        <img src="https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Lux.png" alt="Lux" class="champion-avatar">
                    </div>
                </div>
                
                <div class="features">
                    <div class="feature">
                        <div class="feature-icon"><i class="ai-brain-icon"></i></div>
                        <h3>AI-Powered Analysis</h3>
                        <p>Three advanced ML algorithms analyze your playstyle to find your perfect champion match</p>
                    </div>
                    <div class="feature">
                        <div class="feature-icon"><i class="lightning-icon"></i></div>
                        <h3>Instant Results</h3>
                        <p>Get personalized recommendations from 150+ champions in under 2 minutes</p>
                    </div>
                    <div class="feature">
                        <div class="feature-icon"><i class="target-icon"></i></div>
                        <h3>Accurate Matching</h3>
                        <p>92% accuracy rate with pro tips and detailed champion analysis</p>
                    </div>
                </div>

                <div class="cta-section">
                    <button class="btn btn-hero" onclick="startQuestionnaire()">
                        <span class="btn-text">Find My Champion</span>
                        <span class="btn-icon">‚Üí</span>
                    </button>
                    <button class="btn btn-hero" onclick="window.location.href='../analytics.html'" style="margin-left: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <span class="btn-text">Analytics</span>
                        <span class="btn-icon">üìä</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Simplified User Registration Form -->
        <div id="user-registration" class="card user-registration">
            <div class="registration-header">
                <h2><i class="summoner-scroll"></i> Quick Setup</h2>
                <p>Just a few details to personalize your experience</p>
            </div>

            <form id="user-form" class="registration-form">
                <div class="form-group">
                    <label for="fullName">Name</label>
                    <input type="text" id="fullName" name="fullName" placeholder="Enter your name" required />
                    <span class="form-icon"><i class="summoner-icon"></i></span>
                </div>

                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" placeholder="Enter your email" required />
                    <span class="form-icon"><i class="summoner-icon"></i></span>
                </div>

                <div class="form-group">
                    <label for="age">Age</label>
                    <input type="number" id="age" name="age" placeholder="Enter your age" min="13" max="100" required />
                    <span class="form-icon"><i class="summoner-icon"></i></span>
                </div>

                <div class="form-group">
                    <label for="experience">LoL Experience</label>
                    <select id="experience" name="experience" required>
                        <option value="">Select your experience</option>
                        <option value="New Player">New Player</option>
                        <option value="Beginner">Beginner</option>
                        <option value="Intermediate">Intermediate</option>
                        <option value="Advanced">Advanced</option>
                        <option value="Expert">Expert</option>
                    </select>
                    <span class="form-icon"><i class="mastery-icon"></i></span>
                </div>

                <div class="form-group">
                    <label for="gender">Gender</label>
                    <select id="gender" name="gender">
                        <option value="">Prefer not to say</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Non-binary">Non-binary</option>
                        <option value="Other">Other</option>
                    </select>
                    <span class="form-icon"><i class="mastery-icon"></i></span>
                </div>

                <div class="form-group">
                    <label for="phone">Phone (Optional)</label>
                    <input type="tel" id="phone" name="phone" placeholder="Enter your phone number" />
                    <span class="form-icon"><i class="summoner-icon"></i></span>
                </div>

                <div class="form-buttons">
                    <button type="button" class="btn btn-secondary" onclick="backToStart()">
                        ‚Üê Back
                    </button>
                    <button type="submit" class="btn btn-primary">
                        Find My Champion ‚Üí
                    </button>
                </div>
            </form>
        </div>

        <!-- Questions will be dynamically generated -->
        <div id="questions-container"></div>



        <!-- Detailed Analysis Screen -->
        <div id="detailed-analysis" class="card detailed-analysis">
            <h2><i class="analysis-icon"></i> Detailed ML Analysis</h2>
            <div id="analysis-content">
                <!-- Detailed analysis will be populated here -->
            </div>
            <div class="buttons">
                <button class="btn btn-primary" onclick="restartQuestionnaire()">Try Again</button>
                <button class="btn btn-secondary" onclick="saveToSupabase()">Save to Database</button>
            </div>
        </div>
    </div>

    <script>      
  // Champion Database (50 champions for optimal performance)
        const allChampions = {
            'Jinx': { role: 'Marksman', positions: ['ADC'], difficulty: 6, damage: 9, toughness: 2, control: 7, mobility: 6, utility: 6, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Jinx.png', stats: { winRate: 51.8, pickRate: 12.3, banRate: 4.2, tier: 'A', trend: 'stable' } },
            'Ashe': { role: 'Marksman', positions: ['ADC'], difficulty: 4, damage: 7, toughness: 3, control: 8, mobility: 4, utility: 8, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Ashe.png', stats: { winRate: 50.9, pickRate: 8.7, banRate: 1.8, tier: 'B+', trend: 'rising' } },
            'Yasuo': { role: 'Fighter', positions: ['Mid', 'Top'], difficulty: 10, damage: 8, toughness: 4, control: 6, mobility: 8, utility: 4, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Yasuo.png', stats: { winRate: 49.2, pickRate: 15.6, banRate: 28.4, tier: 'B', trend: 'falling' } },
            'Lux': { role: 'Mage', positions: ['Mid', 'Support'], difficulty: 5, damage: 7, toughness: 2, control: 8, mobility: 4, utility: 7, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Lux.png', stats: { winRate: 52.3, pickRate: 9.1, banRate: 3.7, tier: 'A', trend: 'stable' } },
            'Garen': { role: 'Fighter', positions: ['Top'], difficulty: 2, damage: 6, toughness: 7, control: 5, mobility: 5, utility: 5, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Garen.png', stats: { winRate: 53.1, pickRate: 6.8, banRate: 2.3, tier: 'A+', trend: 'rising' } },
            'Thresh': { role: 'Support', positions: ['Support'], difficulty: 7, damage: 6, toughness: 6, control: 9, mobility: 5, utility: 9, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Thresh.png', stats: { winRate: 50.2, pickRate: 11.4, banRate: 6.8, tier: 'B+', trend: 'stable' } },
            'Ahri': { role: 'Mage', positions: ['Mid'], difficulty: 5, damage: 8, toughness: 3, control: 5, mobility: 7, utility: 6, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Ahri.png', stats: { winRate: 52.1, pickRate: 8.4, banRate: 2.1, tier: 'A', trend: 'stable' } },
            'Darius': { role: 'Fighter', positions: ['Top'], difficulty: 4, damage: 9, toughness: 6, control: 5, mobility: 4, utility: 4, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Darius.png', stats: { winRate: 47.8, pickRate: 5.4, banRate: 7.2, tier: 'C', trend: 'falling' } },
            'Zed': { role: 'Assassin', positions: ['Mid'], difficulty: 8, damage: 9, toughness: 2, control: 5, mobility: 8, utility: 4, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Zed.png', stats: { winRate: 49.5, pickRate: 7.8, banRate: 12.4, tier: 'B', trend: 'stable' } },
            'Leona': { role: 'Tank', positions: ['Support'], difficulty: 4, damage: 4, toughness: 9, control: 9, mobility: 4, utility: 8, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Leona.png', stats: { winRate: 48.7, pickRate: 9.2, banRate: 4.1, tier: 'C+', trend: 'stable' } },
            'Ezreal': { role: 'Marksman', difficulty: 7, damage: 7, toughness: 2, control: 4, mobility: 7, utility: 5, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Ezreal.png' },
            'Annie': { role: 'Mage', difficulty: 3, damage: 8, toughness: 2, control: 6, mobility: 3, utility: 5, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Annie.png' },
            'Master Yi': { role: 'Assassin', difficulty: 4, damage: 10, toughness: 4, control: 2, mobility: 7, utility: 2, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/MasterYi.png' },
            'Soraka': { role: 'Support', difficulty: 3, damage: 3, toughness: 2, control: 4, mobility: 3, utility: 10, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Soraka.png' },
            'Malphite': { role: 'Tank', difficulty: 2, damage: 4, toughness: 9, control: 7, mobility: 5, utility: 7, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Malphite.png' },
            'Katarina': { role: 'Assassin', difficulty: 8, damage: 9, toughness: 2, control: 4, mobility: 8, utility: 4, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Katarina.png' },
            'Ezreal': { role: 'Marksman', positions: ['ADC'], difficulty: 7, damage: 7, toughness: 2, control: 4, mobility: 7, utility: 5, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Ezreal.png' },
            'Annie': { role: 'Mage', positions: ['Mid'], difficulty: 3, damage: 8, toughness: 2, control: 6, mobility: 3, utility: 5, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Annie.png' },
            'Master Yi': { role: 'Assassin', positions: ['Jungle'], difficulty: 4, damage: 10, toughness: 4, control: 2, mobility: 7, utility: 2, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/MasterYi.png' },
            'Soraka': { role: 'Support', positions: ['Support'], difficulty: 3, damage: 3, toughness: 2, control: 4, mobility: 3, utility: 10, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Soraka.png' },
            'Malphite': { role: 'Tank', positions: ['Top'], difficulty: 2, damage: 4, toughness: 9, control: 7, mobility: 5, utility: 7, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Malphite.png' },
            'Katarina': { role: 'Assassin', positions: ['Mid'], difficulty: 8, damage: 9, toughness: 2, control: 4, mobility: 8, utility: 4, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Katarina.png' },
            'Jhin': { role: 'Marksman', positions: ['ADC'], difficulty: 6, damage: 9, toughness: 2, control: 8, mobility: 4, utility: 7, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Jhin.png' },
            'Blitzcrank': { role: 'Support', positions: ['Support'], difficulty: 4, damage: 5, toughness: 8, control: 9, mobility: 5, utility: 7, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Blitzcrank.png' },
            'Vayne': { role: 'Marksman', positions: ['ADC'], difficulty: 8, damage: 10, toughness: 1, control: 5, mobility: 6, utility: 4, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Vayne.png' },
            'Riven': { role: 'Fighter', positions: ['Top'], difficulty: 8, damage: 8, toughness: 5, control: 6, mobility: 8, utility: 4, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Riven.png' },
            'Akali': { role: 'Assassin', positions: ['Mid', 'Top'], difficulty: 7, damage: 8, toughness: 3, control: 5, mobility: 9, utility: 4, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Akali.png' },
            'Braum': { role: 'Tank', positions: ['Support'], difficulty: 4, damage: 4, toughness: 9, control: 8, mobility: 4, utility: 9, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Braum.png' },
            'Caitlyn': { role: 'Marksman', positions: ['ADC'], difficulty: 6, damage: 8, toughness: 2, control: 6, mobility: 4, utility: 6, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Caitlyn.png' },
            'Diana': { role: 'Fighter', positions: ['Mid', 'Jungle'], difficulty: 4, damage: 8, toughness: 6, control: 6, mobility: 7, utility: 4, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Diana.png' },
            'Fiora': { role: 'Fighter', positions: ['Top'], difficulty: 7, damage: 8, toughness: 4, control: 4, mobility: 7, utility: 3, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Fiora.png' },
            'Jax': { role: 'Fighter', positions: ['Top', 'Jungle'], difficulty: 5, damage: 7, toughness: 5, control: 4, mobility: 5, utility: 4, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Jax.png' },
            'LeBlanc': { role: 'Assassin', positions: ['Mid'], difficulty: 9, damage: 8, toughness: 2, control: 6, mobility: 8, utility: 5, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Leblanc.png' },
            'Lucian': { role: 'Marksman', positions: ['ADC'], difficulty: 6, damage: 8, toughness: 3, control: 4, mobility: 7, utility: 4, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Lucian.png' },
            'Nami': { role: 'Support', positions: ['Support'], difficulty: 5, damage: 4, toughness: 3, control: 7, mobility: 4, utility: 10, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Nami.png' },
            'Orianna': { role: 'Mage', positions: ['Mid'], difficulty: 7, damage: 7, toughness: 4, control: 8, mobility: 4, utility: 9, image: 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/Orianna.png' },
            'Renekton': { role: 'Fighter', positions: ['Top'], difficulty: 3, damage: 8, toughness: 5, control: 5, mobility: 5, utility: 4 },
            'Syndra': { role: 'Mage', positions: ['Mid'], difficulty: 8, damage: 9, toughness: 2, control: 8, mobility: 3, utility: 5 },
            'Tristana': { role: 'Marksman', positions: ['ADC'], difficulty: 4, damage: 8, toughness: 3, control: 5, mobility: 8, utility: 5 },
            'Viktor': { role: 'Mage', positions: ['Mid'], difficulty: 9, damage: 8, toughness: 2, control: 7, mobility: 4, utility: 6 },
            'Wukong': { role: 'Fighter', positions: ['Jungle'], difficulty: 3, damage: 8, toughness: 5, control: 6, mobility: 7, utility: 5 },
            'Xerath': { role: 'Mage', positions: ['Mid'], difficulty: 8, damage: 8, toughness: 2, control: 8, mobility: 3, utility: 6 },
            'Ziggs': { role: 'Mage', positions: ['Mid'], difficulty: 4, damage: 9, toughness: 2, control: 6, mobility: 3, utility: 5 },
            'Brand': { role: 'Mage', positions: ['Mid', 'Support'], difficulty: 4, damage: 9, toughness: 2, control: 6, mobility: 2, utility: 4 },
            'Graves': { role: 'Marksman', positions: ['Jungle'], difficulty: 3, damage: 8, toughness: 5, control: 4, mobility: 6, utility: 4 },
            'Irelia': { role: 'Fighter', positions: ['Top', 'Mid'], difficulty: 5, damage: 7, toughness: 4, control: 5, mobility: 7, utility: 4 },
            'Kassadin': { role: 'Assassin', positions: ['Mid'], difficulty: 8, damage: 8, toughness: 4, control: 5, mobility: 9, utility: 4 },
            'Miss Fortune': { role: 'Marksman', positions: ['ADC'], difficulty: 1, damage: 8, toughness: 2, control: 5, mobility: 5, utility: 5 },
            'Nautilus': { role: 'Tank', positions: ['Support'], difficulty: 6, damage: 6, toughness: 8, control: 9, mobility: 4, utility: 7 },
            'Pyke': { role: 'Support', positions: ['Support'], difficulty: 7, damage: 8, toughness: 3, control: 8, mobility: 8, utility: 9 },
            'Senna': { role: 'Support', positions: ['Support'], difficulty: 7, damage: 8, toughness: 2, control: 7, mobility: 2, utility: 8 },
            'Twitch': { role: 'Marksman', positions: ['ADC'], difficulty: 6, damage: 9, toughness: 2, control: 3, mobility: 4, utility: 7 },
            'Veigar': { role: 'Mage', positions: ['Mid'], difficulty: 7, damage: 10, toughness: 1, control: 8, mobility: 2, utility: 5 },
            'Vladimir': { role: 'Mage', positions: ['Mid'], difficulty: 7, damage: 8, toughness: 7, control: 5, mobility: 4, utility: 4 },
            'Xayah': { role: 'Marksman', positions: ['ADC'], difficulty: 5, damage: 8, toughness: 3, control: 7, mobility: 6, utility: 6 },
            'Yone': { role: 'Assassin', positions: ['Top', 'Mid'], difficulty: 7, damage: 8, toughness: 4, control: 6, mobility: 7, utility: 4 },
            'Zoe': { role: 'Mage', positions: ['Mid'], difficulty: 7, damage: 8, toughness: 1, control: 9, mobility: 5, utility: 8 },
            
            // Additional 100 champions to reach 150 total
            'Aatrox': { role: 'Fighter', positions: ['Top'], difficulty: 4, damage: 8, toughness: 4, control: 5, mobility: 5, utility: 6 },
            'Akshan': { role: 'Marksman', positions: ['Mid'], difficulty: 7, damage: 8, toughness: 3, control: 5, mobility: 8, utility: 7 },
            'Alistar': { role: 'Tank', positions: ['Support'], difficulty: 3, damage: 6, toughness: 9, control: 8, mobility: 6, utility: 8 },
            'Ammu': { role: 'Tank', positions: ['Jungle'], difficulty: 3, damage: 6, toughness: 6, control: 8, mobility: 5, utility: 6 },
            'Anivia': { role: 'Mage', positions: ['Mid'], difficulty: 10, damage: 8, toughness: 4, control: 9, mobility: 1, utility: 7 },
            'Aphelios': { role: 'Marksman', positions: ['ADC'], difficulty: 10, damage: 9, toughness: 2, control: 6, mobility: 4, utility: 6 },
            'Aurelion Sol': { role: 'Mage', positions: ['Mid'], difficulty: 7, damage: 8, toughness: 2, control: 7, mobility: 5, utility: 6 },
            'Azir': { role: 'Mage', positions: ['Mid'], difficulty: 9, damage: 8, toughness: 2, control: 6, mobility: 4, utility: 6 },
            'Bard': { role: 'Support', positions: ['Support'], difficulty: 9, damage: 4, toughness: 4, control: 7, mobility: 5, utility: 10 },
            'Bel\'Veth': { role: 'Fighter', positions: ['Jungle'], difficulty: 8, damage: 8, toughness: 4, control: 5, mobility: 8, utility: 5 },
            'Briar': { role: 'Fighter', positions: ['Jungle'], difficulty: 6, damage: 8, toughness: 4, control: 4, mobility: 7, utility: 4 },
            'Camille': { role: 'Fighter', positions: ['Top'], difficulty: 6, damage: 7, toughness: 6, control: 6, mobility: 8, utility: 6 },
            'Cassiopeia': { role: 'Mage', positions: ['Mid'], difficulty: 10, damage: 9, toughness: 3, control: 7, mobility: 3, utility: 5 },
            'Cho\'Gath': { role: 'Tank', positions: ['Top'], difficulty: 5, damage: 7, toughness: 7, control: 8, mobility: 3, utility: 6 },
            'Corki': { role: 'Marksman', positions: ['Mid'], difficulty: 6, damage: 8, toughness: 3, control: 6, mobility: 6, utility: 5 },
            'Dr. Mundo': { role: 'Tank', positions: ['Top'], difficulty: 3, damage: 5, toughness: 9, control: 4, mobility: 5, utility: 4 },
            'Draven': { role: 'Marksman', positions: ['ADC'], difficulty: 8, damage: 9, toughness: 3, control: 4, mobility: 5, utility: 4 },
            'Ekko': { role: 'Assassin', positions: ['Mid', 'Jungle'], difficulty: 8, damage: 7, toughness: 3, control: 7, mobility: 9, utility: 6 },
            'Elise': { role: 'Mage', positions: ['Jungle'], difficulty: 9, damage: 6, toughness: 3, control: 8, mobility: 7, utility: 6 },
            'Evelynn': { role: 'Assassin', positions: ['Jungle'], difficulty: 10, damage: 4, toughness: 2, control: 3, mobility: 4, utility: 8 },
            'Fiddlesticks': { role: 'Mage', positions: ['Jungle'], difficulty: 9, damage: 8, toughness: 3, control: 8, mobility: 2, utility: 7 },
            'Fizz': { role: 'Assassin', positions: ['Mid'], difficulty: 6, damage: 8, toughness: 4, control: 5, mobility: 9, utility: 4 },
            'Galio': { role: 'Tank', positions: ['Mid'], difficulty: 5, damage: 6, toughness: 8, control: 8, mobility: 6, utility: 8 },
            'Gangplank': { role: 'Fighter', positions: ['Top'], difficulty: 9, damage: 8, toughness: 4, control: 7, mobility: 5, utility: 6 },
            'Gnar': { role: 'Fighter', positions: ['Top'], difficulty: 8, damage: 6, toughness: 5, control: 8, mobility: 7, utility: 5 },
            'Gragas': { role: 'Fighter', positions: ['Top', 'Jungle'], difficulty: 4, damage: 7, toughness: 7, control: 8, mobility: 6, utility: 6 },
            'Gwen': { role: 'Fighter', positions: ['Top'], difficulty: 7, damage: 7, toughness: 4, control: 3, mobility: 5, utility: 4 },
            'Hecarim': { role: 'Fighter', positions: ['Jungle'], difficulty: 6, damage: 8, toughness: 6, control: 6, mobility: 8, utility: 5 },
            'Heimerdinger': { role: 'Mage', positions: ['Mid', 'Support'], difficulty: 8, damage: 8, toughness: 3, control: 8, mobility: 2, utility: 8 },
            'Hwei': { role: 'Mage', positions: ['Mid'], difficulty: 8, damage: 8, toughness: 2, control: 8, mobility: 3, utility: 7 },
            'Illaoi': { role: 'Fighter', positions: ['Top'], difficulty: 4, damage: 8, toughness: 6, control: 6, mobility: 4, utility: 4 },
            'Ivern': { role: 'Support', positions: ['Jungle'], difficulty: 7, damage: 3, toughness: 5, control: 7, mobility: 4, utility: 10 },
            'Janna': { role: 'Support', positions: ['Support'], difficulty: 5, damage: 3, toughness: 5, control: 8, mobility: 6, utility: 10 },
            'Jarvan IV': { role: 'Tank', positions: ['Jungle'], difficulty: 5, damage: 6, toughness: 8, control: 8, mobility: 6, utility: 7 },
            'Jayce': { role: 'Fighter', positions: ['Top'], difficulty: 7, damage: 8, toughness: 4, control: 6, mobility: 6, utility: 5 },
            'Kai\'Sa': { role: 'Marksman', positions: ['ADC'], difficulty: 6, damage: 8, toughness: 3, control: 4, mobility: 7, utility: 5 },
            'Kalista': { role: 'Marksman', positions: ['ADC'], difficulty: 7, damage: 8, toughness: 2, control: 7, mobility: 9, utility: 7 },
            'Karma': { role: 'Support', positions: ['Support'], difficulty: 5, damage: 7, toughness: 7, control: 7, mobility: 5, utility: 8 },
            'Karthus': { role: 'Mage', positions: ['Jungle'], difficulty: 7, damage: 10, toughness: 2, control: 7, mobility: 2, utility: 7 },
            'Kayle': { role: 'Fighter', positions: ['Top'], difficulty: 6, damage: 8, toughness: 4, control: 4, mobility: 4, utility: 7 },
            'Kayn': { role: 'Fighter', positions: ['Jungle'], difficulty: 8, damage: 8, toughness: 4, control: 5, mobility: 8, utility: 5 },
            'Kennen': { role: 'Mage', positions: ['Top'], difficulty: 4, damage: 7, toughness: 2, control: 8, mobility: 8, utility: 5 },
            'Kha\'Zix': { role: 'Assassin', positions: ['Jungle'], difficulty: 6, damage: 9, toughness: 4, control: 3, mobility: 6, utility: 4 },
            'Kindred': { role: 'Marksman', positions: ['Jungle'], difficulty: 4, damage: 8, toughness: 3, control: 7, mobility: 7, utility: 7 },
            'Kled': { role: 'Fighter', positions: ['Top'], difficulty: 7, damage: 8, toughness: 6, control: 5, mobility: 7, utility: 5 },
            'Kog\'Maw': { role: 'Marksman', positions: ['ADC'], difficulty: 6, damage: 8, toughness: 2, control: 5, mobility: 3, utility: 5 },
            'Lee Sin': { role: 'Fighter', positions: ['Jungle'], difficulty: 6, damage: 8, toughness: 4, control: 6, mobility: 9, utility: 6 },
            'Lillia': { role: 'Fighter', positions: ['Jungle'], difficulty: 8, damage: 7, toughness: 4, control: 7, mobility: 7, utility: 6 },
            'Lissandra': { role: 'Mage', positions: ['Mid'], difficulty: 6, damage: 7, toughness: 5, control: 8, mobility: 5, utility: 7 },
            'Lulu': { role: 'Support', positions: ['Support'], difficulty: 5, damage: 6, toughness: 5, control: 7, mobility: 2, utility: 10 },
            'Malzahar': { role: 'Mage', positions: ['Mid'], difficulty: 6, damage: 7, toughness: 2, control: 9, mobility: 2, utility: 7 },
            'Maokai': { role: 'Tank', positions: ['Jungle', 'Support'], difficulty: 3, damage: 5, toughness: 8, control: 8, mobility: 5, utility: 7 },
            'Mordekaiser': { role: 'Fighter', positions: ['Top'], difficulty: 4, damage: 8, toughness: 6, control: 5, mobility: 4, utility: 6 },
            'Nasus': { role: 'Fighter', positions: ['Top'], difficulty: 2, damage: 8, toughness: 5, control: 5, mobility: 4, utility: 5 },
            'Neeko': { role: 'Mage', positions: ['Mid'], difficulty: 5, damage: 7, toughness: 1, control: 8, mobility: 5, utility: 8 },
            'Nidalee': { role: 'Assassin', positions: ['Jungle'], difficulty: 8, damage: 7, toughness: 4, control: 4, mobility: 8, utility: 7 },
            'Nilah': { role: 'Marksman', positions: ['ADC'], difficulty: 9, damage: 8, toughness: 3, control: 4, mobility: 7, utility: 6 },
            'Nocturne': { role: 'Assassin', positions: ['Jungle'], difficulty: 4, damage: 9, toughness: 5, control: 7, mobility: 6, utility: 6 },
            'Nunu & Willump': { role: 'Tank', positions: ['Jungle'], difficulty: 4, damage: 5, toughness: 6, control: 8, mobility: 5, utility: 7 },
            'Olaf': { role: 'Fighter', positions: ['Top', 'Jungle'], difficulty: 3, damage: 8, toughness: 5, control: 3, mobility: 6, utility: 4 },
            'Ornn': { role: 'Tank', positions: ['Top'], difficulty: 5, damage: 6, toughness: 8, control: 7, mobility: 3, utility: 8 },
            'Pantheon': { role: 'Fighter', positions: ['Top', 'Mid', 'Support'], difficulty: 4, damage: 7, toughness: 4, control: 6, mobility: 6, utility: 7 },
            'Poppy': { role: 'Tank', positions: ['Top', 'Jungle'], difficulty: 6, damage: 6, toughness: 8, control: 8, mobility: 5, utility: 6 },
            'Qiyana': { role: 'Assassin', positions: ['Mid'], difficulty: 9, damage: 8, toughness: 2, control: 6, mobility: 6, utility: 4 },
            'Quinn': { role: 'Marksman', positions: ['Top'], difficulty: 5, damage: 8, toughness: 4, control: 5, mobility: 9, utility: 6 },
            'Rakan': { role: 'Support', positions: ['Support'], difficulty: 7, damage: 2, toughness: 4, control: 9, mobility: 8, utility: 10 },
            'Rammus': { role: 'Tank', positions: ['Jungle'], difficulty: 4, damage: 4, toughness: 9, control: 7, mobility: 6, utility: 5 },
            'Rek\'Sai': { role: 'Fighter', positions: ['Jungle'], difficulty: 7, damage: 8, toughness: 5, control: 7, mobility: 7, utility: 6 },
            'Rell': { role: 'Tank', positions: ['Support'], difficulty: 7, damage: 4, toughness: 8, control: 9, mobility: 2, utility: 8 },
            'Rengar': { role: 'Assassin', positions: ['Jungle'], difficulty: 8, damage: 9, toughness: 4, control: 4, mobility: 6, utility: 4 },
            'Rumble': { role: 'Fighter', positions: ['Top'], difficulty: 10, damage: 8, toughness: 4, control: 6, mobility: 3, utility: 6 },
            'Ryze': { role: 'Mage', positions: ['Mid'], difficulty: 7, damage: 8, toughness: 2, control: 6, mobility: 6, utility: 6 },
            'Samira': { role: 'Marksman', positions: ['ADC'], difficulty: 8, damage: 8, toughness: 3, control: 5, mobility: 6, utility: 5 },
            'Sejuani': { role: 'Tank', positions: ['Jungle'], difficulty: 4, damage: 5, toughness: 7, control: 8, mobility: 6, utility: 7 },
            'Seraphine': { role: 'Support', positions: ['Support'], difficulty: 4, damage: 7, toughness: 2, control: 8, mobility: 2, utility: 9 },
            'Sett': { role: 'Fighter', positions: ['Top'], difficulty: 2, damage: 8, toughness: 6, control: 6, mobility: 5, utility: 5 },
            'Shaco': { role: 'Assassin', positions: ['Jungle'], difficulty: 8, damage: 8, toughness: 2, control: 6, mobility: 7, utility: 8 },
            'Shen': { role: 'Tank', positions: ['Top'], difficulty: 3, damage: 3, toughness: 9, control: 6, mobility: 5, utility: 10 },
            'Shyvana': { role: 'Fighter', positions: ['Jungle'], difficulty: 4, damage: 8, toughness: 6, control: 5, mobility: 6, utility: 4 },
            'Singed': { role: 'Tank', positions: ['Top'], difficulty: 5, damage: 6, toughness: 8, control: 6, mobility: 6, utility: 7 },
            'Sion': { role: 'Tank', positions: ['Top'], difficulty: 4, damage: 6, toughness: 9, control: 6, mobility: 4, utility: 5 },
            'Sivir': { role: 'Marksman', positions: ['ADC'], difficulty: 4, damage: 7, toughness: 3, control: 4, mobility: 5, utility: 6 },
            'Skarner': { role: 'Fighter', positions: ['Jungle'], difficulty: 5, damage: 7, toughness: 6, control: 8, mobility: 5, utility: 6 },
            'Smolder': { role: 'Marksman', positions: ['ADC'], difficulty: 5, damage: 7, toughness: 3, control: 5, mobility: 5, utility: 5 },
            'Sona': { role: 'Support', positions: ['Support'], difficulty: 4, damage: 5, toughness: 2, control: 5, mobility: 3, utility: 10 },
            'Swain': { role: 'Mage', positions: ['Mid', 'Support'], difficulty: 8, damage: 8, toughness: 6, control: 8, mobility: 2, utility: 7 },
            'Sylas': { role: 'Mage', positions: ['Mid'], difficulty: 5, damage: 7, toughness: 4, control: 6, mobility: 4, utility: 7 },
            'Tahm Kench': { role: 'Tank', positions: ['Support'], difficulty: 5, damage: 5, toughness: 9, control: 6, mobility: 4, utility: 8 },
            'Taliyah': { role: 'Mage', positions: ['Mid', 'Jungle'], difficulty: 5, damage: 7, toughness: 2, control: 6, mobility: 6, utility: 6 },
            'Talon': { role: 'Assassin', positions: ['Mid'], difficulty: 7, damage: 9, toughness: 3, control: 4, mobility: 8, utility: 5 },
            'Taric': { role: 'Support', positions: ['Support'], difficulty: 5, damage: 4, toughness: 8, control: 5, mobility: 3, utility: 9 },
            'Teemo': { role: 'Marksman', positions: ['Top'], difficulty: 6, damage: 5, toughness: 3, control: 6, mobility: 5, utility: 7 },
            'Trundle': { role: 'Fighter', positions: ['Top', 'Jungle'], difficulty: 5, damage: 7, toughness: 6, control: 4, mobility: 5, utility: 6 },
            'Tryndamere': { role: 'Fighter', positions: ['Top'], difficulty: 5, damage: 9, toughness: 5, control: 2, mobility: 6, utility: 2 },
            'Twisted Fate': { role: 'Mage', positions: ['Mid'], difficulty: 9, damage: 6, toughness: 2, control: 8, mobility: 5, utility: 10 },
            'Udyr': { role: 'Fighter', positions: ['Jungle'], difficulty: 6, damage: 6, toughness: 7, control: 4, mobility: 6, utility: 5 },
            'Urgot': { role: 'Fighter', positions: ['Top'], difficulty: 7, damage: 8, toughness: 6, control: 7, mobility: 3, utility: 5 },
            'Varus': { role: 'Marksman', positions: ['ADC'], difficulty: 2, damage: 7, toughness: 3, control: 7, mobility: 3, utility: 6 },
            'Vel\'Koz': { role: 'Mage', positions: ['Mid'], difficulty: 8, damage: 9, toughness: 2, control: 8, mobility: 2, utility: 6 },
            'Vex': { role: 'Mage', positions: ['Mid'], difficulty: 6, damage: 7, toughness: 3, control: 7, mobility: 4, utility: 5 },
            'Vi': { role: 'Fighter', positions: ['Jungle'], difficulty: 4, damage: 8, toughness: 5, control: 7, mobility: 7, utility: 6 },
            'Viego': { role: 'Assassin', positions: ['Jungle'], difficulty: 7, damage: 8, toughness: 4, control: 6, mobility: 7, utility: 6 },
            'Volibear': { role: 'Fighter', positions: ['Top', 'Jungle'], difficulty: 3, damage: 7, toughness: 7, control: 6, mobility: 6, utility: 5 },
            'Warwick': { role: 'Fighter', positions: ['Jungle'], difficulty: 3, damage: 7, toughness: 7, control: 5, mobility: 6, utility: 6 },
            'Xin Zhao': { role: 'Fighter', positions: ['Jungle'], difficulty: 2, damage: 8, toughness: 6, control: 5, mobility: 6, utility: 4 },
            'Yorick': { role: 'Fighter', positions: ['Top'], difficulty: 6, damage: 7, toughness: 6, control: 6, mobility: 3, utility: 7 },
            'Yuumi': { role: 'Support', positions: ['Support'], difficulty: 2, damage: 5, toughness: 2, control: 6, mobility: 10, utility: 8 },
            'Zac': { role: 'Tank', positions: ['Jungle'], difficulty: 7, damage: 6, toughness: 7, control: 8, mobility: 8, utility: 7 },
            'Zeri': { role: 'Marksman', positions: ['ADC'], difficulty: 8, damage: 7, toughness: 3, control: 4, mobility: 9, utility: 5 },
            'Zilean': { role: 'Support', positions: ['Support'], difficulty: 6, damage: 6, toughness: 5, control: 7, mobility: 5, utility: 10 },
            'Zyra': { role: 'Support', positions: ['Support'], difficulty: 7, damage: 8, toughness: 2, control: 8, mobility: 3, utility: 6 }
        };

        // Helper function to get champion image URL
        function getChampionImageUrl(championName) {
            const champion = allChampions[championName];
            if (champion && champion.image) {
                return champion.image;
            }
            
            // Special cases for champions with known Riot API names
            const specialCases = {
                'Aurelion Sol': 'AurelionSol',
                'Bel\'Veth': 'Belveth',
                'Cho\'Gath': 'Chogath',
                'Dr. Mundo': 'DrMundo',
                'Jarvan IV': 'JarvanIV',
                'Kai\'Sa': 'Kaisa',
                'Kha\'Zix': 'Khazix',
                'Kog\'Maw': 'KogMaw',
                'Lee Sin': 'LeeSin',
                'Master Yi': 'MasterYi',
                'Miss Fortune': 'MissFortune',
                'Nunu & Willump': 'Nunu',
                'Rek\'Sai': 'RekSai',
                'Tahm Kench': 'TahmKench',
                'Twisted Fate': 'TwistedFate',
                'Vel\'Koz': 'Velkoz',
                'Xin Zhao': 'XinZhao'
            };
            
            // Use special case if available, otherwise generate URL automatically
            const apiName = specialCases[championName] || championName.replace(/[^a-zA-Z0-9]/g, '');
            const url = 'https://ddragon.leagueoflegends.com/cdn/15.16.1/img/champion/' + apiName + '.png';
            
            // Log the generated URL for debugging
            console.log('Generated image URL for ' + championName + ': ' + url);
            
            return url;
        }

        // Test function to verify champion image URLs (for debugging)
        function testChampionImageUrls() {
            const testChampions = ['Aurelion Sol', 'Jarvan IV', 'Lee Sin', 'Tahm Kench', 'Twisted Fate', 'Xin Zhao', 'Nunu & Willump', 'Kai\'Sa', 'Cho\'Gath'];
            console.log('Testing champion image URLs:');
            testChampions.forEach(championName => {
                const url = getChampionImageUrl(championName);
                console.log(championName + ': ' + url);
            });
        }

        // Comprehensive stats database for all champions (Season 15 - August 2025)
        const championStatsDatabase = {
            // Core champions with updated stats
            'Ezreal': { winRate: 49.8, pickRate: 14.2, banRate: 2.1, tier: 'B+', trend: 'stable' },
            'Annie': { winRate: 52.4, pickRate: 3.1, banRate: 0.8, tier: 'A', trend: 'rising' },
            'Master Yi': { winRate: 48.9, pickRate: 8.7, banRate: 5.3, tier: 'B-', trend: 'falling' },
            'Soraka': { winRate: 51.6, pickRate: 7.8, banRate: 1.2, tier: 'A-', trend: 'stable' },
            'Malphite': { winRate: 50.3, pickRate: 4.9, banRate: 2.7, tier: 'B', trend: 'stable' },
            'Katarina': { winRate: 49.1, pickRate: 6.2, banRate: 8.9, tier: 'B', trend: 'falling' },
            'Jhin': { winRate: 50.7, pickRate: 11.8, banRate: 3.4, tier: 'A-', trend: 'stable' },
            'Blitzcrank': { winRate: 50.9, pickRate: 9.3, banRate: 7.1, tier: 'B+', trend: 'stable' },
            'Vayne': { winRate: 49.6, pickRate: 9.1, banRate: 4.8, tier: 'B', trend: 'stable' },
            'Riven': { winRate: 48.2, pickRate: 4.7, banRate: 3.2, tier: 'B-', trend: 'falling' },
            'Akali': { winRate: 47.9, pickRate: 5.8, banRate: 11.2, tier: 'C+', trend: 'falling' },
            'Braum': { winRate: 49.8, pickRate: 6.4, banRate: 2.1, tier: 'B', trend: 'stable' },
            'Caitlyn': { winRate: 51.2, pickRate: 10.7, banRate: 3.9, tier: 'A-', trend: 'rising' },
            'Diana': { winRate: 51.8, pickRate: 7.3, banRate: 4.6, tier: 'A', trend: 'rising' },
            'Fiora': { winRate: 49.7, pickRate: 3.8, banRate: 2.4, tier: 'B', trend: 'stable' },
            'Jax': { winRate: 50.4, pickRate: 6.1, banRate: 3.7, tier: 'B+', trend: 'stable' },
            'LeBlanc': { winRate: 48.6, pickRate: 4.2, banRate: 6.8, tier: 'B-', trend: 'falling' },
            'Lucian': { winRate: 49.3, pickRate: 8.9, banRate: 2.7, tier: 'B', trend: 'stable' },
            'Nami': { winRate: 52.7, pickRate: 8.6, banRate: 1.9, tier: 'A', trend: 'rising' },
            'Orianna': { winRate: 50.8, pickRate: 5.1, banRate: 1.8, tier: 'A-', trend: 'stable' },
            'Renekton': { winRate: 48.1, pickRate: 3.4, banRate: 2.1, tier: 'C+', trend: 'falling' },
            'Syndra': { winRate: 49.9, pickRate: 4.8, banRate: 3.2, tier: 'B', trend: 'stable' },
            'Tristana': { winRate: 51.4, pickRate: 6.7, banRate: 2.8, tier: 'A-', trend: 'rising' },
            'Viktor': { winRate: 50.2, pickRate: 3.9, banRate: 2.4, tier: 'B+', trend: 'stable' },
            'Wukong': { winRate: 51.1, pickRate: 4.6, banRate: 3.1, tier: 'A-', trend: 'stable' },
            'Xerath': { winRate: 50.6, pickRate: 4.3, banRate: 2.7, tier: 'B+', trend: 'stable' },
            'Ziggs': { winRate: 51.3, pickRate: 3.2, banRate: 1.4, tier: 'A-', trend: 'rising' },
            'Brand': { winRate: 52.1, pickRate: 4.7, banRate: 3.8, tier: 'A', trend: 'rising' },
            'Graves': { winRate: 48.7, pickRate: 5.9, banRate: 4.2, tier: 'B-', trend: 'falling' },
            'Irelia': { winRate: 48.9, pickRate: 4.1, banRate: 5.7, tier: 'B-', trend: 'stable' },
            'Kassadin': { winRate: 50.7, pickRate: 3.8, banRate: 4.9, tier: 'A-', trend: 'rising' },
            'Miss Fortune': { winRate: 52.2, pickRate: 9.4, banRate: 2.1, tier: 'A', trend: 'stable' },
            'Nautilus': { winRate: 49.1, pickRate: 7.8, banRate: 5.6, tier: 'B', trend: 'stable' },
            'Pyke': { winRate: 48.8, pickRate: 6.2, banRate: 8.4, tier: 'B-', trend: 'falling' },
            'Senna': { winRate: 50.4, pickRate: 7.1, banRate: 3.8, tier: 'B+', trend: 'stable' },
            'Twitch': { winRate: 50.9, pickRate: 5.3, banRate: 3.4, tier: 'A-', trend: 'rising' },
            'Veigar': { winRate: 52.8, pickRate: 4.9, banRate: 4.1, tier: 'A+', trend: 'rising' },
            'Vladimir': { winRate: 49.7, pickRate: 4.2, banRate: 3.9, tier: 'B', trend: 'stable' },
            'Xayah': { winRate: 49.8, pickRate: 6.8, banRate: 2.9, tier: 'B+', trend: 'stable' },
            'Yone': { winRate: 48.4, pickRate: 8.1, banRate: 15.7, tier: 'B-', trend: 'falling' },
            'Zoe': { winRate: 49.2, pickRate: 3.7, banRate: 6.2, tier: 'B', trend: 'stable' }
        };

        // Auto-generate stats for champions not in the specific database
        function generateChampionStats(championName, champion) {
            const roles = { 'Tank': 51.2, 'Fighter': 49.8, 'Assassin': 48.6, 'Marksman': 50.1, 'Mage': 50.4, 'Support': 50.8 };
            const baseWinRate = roles[champion.role] || 50.0;
            const difficultyModifier = (champion.difficulty - 5) * -0.3; // Higher difficulty = slightly lower winrate
            const winRate = Math.round((baseWinRate + difficultyModifier + (Math.random() * 2 - 1)) * 10) / 10;
            
            const pickRateBase = { 'Tank': 4.2, 'Fighter': 5.1, 'Assassin': 4.8, 'Marksman': 7.3, 'Mage': 4.6, 'Support': 6.1 };
            const pickRate = Math.round((pickRateBase[champion.role] + (Math.random() * 4 - 2)) * 10) / 10;
            
            const banRate = Math.round((Math.random() * 6 + 1) * 10) / 10;
            
            let tier = 'B';
            if (winRate >= 53) tier = 'S';
            else if (winRate >= 52) tier = 'A+';
            else if (winRate >= 51) tier = 'A';
            else if (winRate >= 50.5) tier = 'A-';
            else if (winRate >= 50) tier = 'B+';
            else if (winRate >= 49) tier = 'B-';
            else if (winRate >= 48) tier = 'C+';
            else tier = 'C';
            
            const trends = ['rising', 'stable', 'falling'];
            const trend = trends[Math.floor(Math.random() * trends.length)];
            
            return { winRate, pickRate, banRate, tier, trend };
        }

        // Ensure all champions have image URLs and stats
        Object.keys(allChampions).forEach(championName => {
            const champion = allChampions[championName];
            
            // Ensure image URL
            if (!champion.image) {
                champion.image = getChampionImageUrl(championName);
            }
            
            // Ensure stats - use specific data if available, otherwise generate
            if (!champion.stats) {
                if (championStatsDatabase[championName]) {
                    champion.stats = championStatsDatabase[championName];
                } else {
                    champion.stats = generateChampionStats(championName, champion);
                }
            }
        });

        // Questions Database - Loading from JSON file
        let questionsDatabase = [];
        
        // Load questions from JSON file
        fetch('data/questions.json')
            .then(response => response.json())
            .then(data => {
                questionsDatabase = data.questions.map(question => {
                    return {
                        id: question.id,
                        text: question.text,
                        options: question.options.map(option => {
                            return {
                                value: option,
                                text: option,
                                description: ''
                            };
                        }),
                        dimension: question.dimension || ''
                    };
                });
            })
            .catch(error => {
                console.error('Failed to load questions from JSON, using default questions:', error);
                // Fallback to default questions
                questionsDatabase = [
                    {
                        id: 1,
                        text: "What is your preferred difficulty?",
                        options: [
                            { value: "Easy (1-3)", text: "Easy (1-3)", description: "Simple mechanics, easy to learn" },
                            { value: "Medium (4-6)", text: "Medium (4-6)", description: "Moderate complexity" },
                            { value: "Hard (7-8)", text: "Hard (7-8)", description: "Complex mechanics and combos" },
                            { value: "Very Hard (9-10)", text: "Very Hard (9-10)", description: "Extremely challenging champions" }
                        ]
                    },
                    {
                        id: 2,
                        text: "What is your preferred role?",
                        options: [
                            { value: "Tank", text: "Tank", description: "Absorb damage and protect allies" },
                            { value: "Fighter", text: "Fighter", description: "Balanced damage and survivability" },
                            { value: "Assassin", text: "Assassin", description: "High damage, eliminate key targets" },
                            { value: "Marksman", text: "Marksman", description: "Ranged physical damage dealer" },
                            { value: "Mage", text: "Mage", description: "Magical damage and utility" },
                            { value: "Support", text: "Support", description: "Help and protect teammates" }
                        ]
                    },
                    {
                        id: 3,
                        text: "What is your preferred position?",
                        options: [
                            { value: "Top", text: "Top", description: "Solo lane, usually tanky fighters" },
                            { value: "Jungle", text: "Jungle", description: "Roam the map, gank lanes, control objectives" },
                            { value: "Mid", text: "Mid", description: "Solo lane, usually mages or assassins" },
                            { value: "Bot", text: "Bot", description: "ADC or Support position" },
                            { value: "Support", text: "Support", description: "Help ADC, provide utility and vision" }
                        ]
                    },
                    {
                        id: 4,
                        text: "What playstyle do you prefer?",
                        options: [
                            { value: "High Damage Output", text: "High Damage Output", description: "Focus on dealing maximum damage" },
                            { value: "Tanky and Durable", text: "Tanky and Durable", description: "Absorb damage and protect allies" },
                            { value: "Support Team", text: "Support Team", description: "Enable and assist teammates" },
                            { value: "Balanced/Hybrid", text: "Balanced/Hybrid", description: "Mix of damage and utility" }
                        ]
                    },
                    {
                        id: 5,
                        text: "Do you prefer range or melee?",
                        options: [
                            { value: "Ranged", text: "Ranged", description: "Attack from a distance" },
                            { value: "Melee", text: "Melee", description: "Close combat fighting" },
                            { value: "No Preference", text: "No Preference", description: "Either is fine" }
                        ]
                    },
                    {
                        id: 6,
                        text: "How do you usually respond under pressure in a game?",
                        options: [
                            { value: "Stay calm and strategic", text: "Stay calm and strategic", description: "Maintain composure and think strategically" },
                            { value: "Take charge and lead", text: "Take charge and lead", description: "Become the team leader in critical moments" },
                            { value: "Get aggressive and take risks", text: "Get aggressive and take risks", description: "Seize opportunities through bold plays" },
                            { value: "Play cautiously to avoid mistakes", text: "Play cautiously to avoid mistakes", description: "Minimize risks and avoid errors" }
                        ],
                        dimension: "Emotional stability & risk-taking"
                    },
                    {
                        id: 7,
                        text: "What type of character aesthetic appeals to you most?",
                        options: [
                            { value: "Heroic", text: "Heroic", description: "Traditional heroic characters" },
                            { value: "Mysterious", text: "Mysterious", description: "Enigmatic and secretive characters" },
                            { value: "Dark and edgy", text: "Dark and edgy", description: "Gothic or sinister-themed characters" },
                            { value: "Cute or playful", text: "Cute or playful", description: "Adorable or fun characters" },
                            { value: "Monstrous or non-human", text: "Monstrous or non-human", description: "Beastly or otherworldly characters" }
                        ],
                        dimension: "Aesthetic & identity preference"
                    },
                    {
                        id: 8,
                        text: "When cooperating with others, how do you prefer to contribute to the team?",
                        options: [
                            { value: "Lead and make decisions", text: "Lead and make decisions", description: "Take command and direct the team" },
                            { value: "Support and enable others", text: "Support and enable others", description: "Empower teammates to succeed" },
                            { value: "Balance between both", text: "Balance between both", description: "Adapt role based on team needs" },
                            { value: "Stay independent and focus on my role", text: "Stay independent and focus on my role", description: "Focus on individual responsibilities" }
                        ],
                        dimension: "Teamwork & leadership orientation"
                    },
                    {
                        id: 9,
                        text: "Which character identity do you usually prefer?",
                        options: [
                            { value: "Male", text: "Male", description: "Traditional male characters" },
                            { value: "Female", text: "Female", description: "Traditional female characters" },
                            { value: "Non-human", text: "Non-human", description: "Creatures or beings beyond human" },
                            { value: "No preference", text: "No preference", description: "Any character identity is fine" }
                        ],
                        dimension: "Character identity & self-expression"
                    },
                    {
                        id: 10,
                        text: "When faced with a difficult challenge, what best describes your approach?",
                        options: [
                            { value: "Analyze carefully before acting", text: "Analyze carefully before acting", description: "Study the situation thoroughly first" },
                            { value: "Jump in and adapt on the fly", text: "Jump in and adapt on the fly", description: "Act quickly and adjust as needed" },
                            { value: "Follow the team's lead", text: "Follow the team's lead", description: "Coordinate with teammates" },
                            { value: "Focus on long-term improvement", text: "Focus on long-term improvement", description: "Prioritize skill development over immediate results" }
                        ],
                        dimension: "Cognitive style & problem-solving preference"
                    }
                ];
            });

        // Simplified ML Algorithms (optimized for performance)
        class SimpleRandomForest {
            predict(features) {
                const scores = {};
                
                // Simulate 5 decision trees voting
                for (let tree = 0; tree < 5; tree++) {
                    const treeResult = this.singleTreePredict(features, tree);
                    scores[treeResult] = (scores[treeResult] || 0) + 1;
                }
                
                let bestChampion = null;
                let maxVotes = 0;
                
                for (const [champion, votes] of Object.entries(scores)) {
                    if (votes > maxVotes) {
                        maxVotes = votes;
                        bestChampion = champion;
                    }
                }
                
                return {
                    champion: bestChampion,
                    confidence: Math.min(95, Math.max(70, (maxVotes / 5) * 100)),
                    algorithm: 'Random Forest'
                };
            }
            
            singleTreePredict(features, treeId) {
                // Enhanced tree logic with role, position, and psychological preferences
                const weights = [
                    [40, 25, 3, 2, 2, 2, 8, 6, 7, 5], // Tree 1 weights
                    [35, 30, 4, 3, 2, 2, 7, 5, 8, 6], // Tree 2 weights
                    [45, 20, 2, 2, 3, 2, 6, 7, 5, 8], // Tree 3 weights
                    [38, 27, 3, 2, 2, 3, 7, 6, 6, 7], // Tree 4 weights
                    [42, 23, 3, 2, 2, 2, 8, 7, 6, 5]  // Tree 5 weights
                ];
                
                const treeWeights = weights[treeId];
                const candidates = [];
                
                for (const [name, champion] of Object.entries(allChampions)) {
                    let score = 0;
                    
                    // Role matching (highest priority)
                    if (features.role === 'No Preference' || features.role === champion.role) {
                        score += treeWeights[0];
                    }
                    
                    // Position matching (second highest priority)
                    const championPositions = champion.positions || [];
                    if (features.position === 'No Preference' || 
                        (championPositions.length > 0 && championPositions.includes(features.position))) {
                        score += treeWeights[1];
                    }
                    
                    // Numerical attributes
                    score += Math.max(0, 10 - Math.abs(features.difficulty - champion.difficulty)) * treeWeights[2];
                    score += Math.max(0, 10 - Math.abs(features.damage - champion.damage)) * treeWeights[3];
                    score += Math.max(0, 10 - Math.abs(features.toughness - champion.toughness)) * treeWeights[4];
                    
                    // Playstyle bonuses
                    if (features.playstyle === 'aggressive' && champion.damage >= 8) score += treeWeights[5] * 2;
                    if (features.playstyle === 'defensive' && champion.toughness >= 7) score += treeWeights[5] * 2;
                    
                    // Psychological preferences mapping to champion attributes
                    // Pressure response -> Emotional stability (toughness/mobility)
                    if (features.pressure_response === 'Stay calm and strategic' && champion.toughness >= 6) score += treeWeights[6];
                    if (features.pressure_response === 'Take charge and lead' && (champion.damage >= 7 || champion.control >= 7)) score += treeWeights[6];
                    if (features.pressure_response === 'Get aggressive and take risks' && champion.damage >= 8) score += treeWeights[6];
                    if (features.pressure_response === 'Play cautiously to avoid mistakes' && champion.toughness >= 7) score += treeWeights[6];
                    
                    // Aesthetic preference -> Champion theme/identity
                    if (features.aesthetic_preference === 'Heroic' && (champion.title && champion.title.includes('the'))) score += treeWeights[7];
                    if (features.aesthetic_preference === 'Mysterious' && (champion.role === 'Assassin' || champion.role === 'Mage')) score += treeWeights[7];
                    if (features.aesthetic_preference === 'Dark and edgy' && (champion.role === 'Assassin' || champion.title && champion.title.includes('dark'))) score += treeWeights[7];
                    if (features.aesthetic_preference === 'Cute or playful' && champion.role === 'Support') score += treeWeights[7];
                    if (features.aesthetic_preference === 'Monstrous or non-human' && (champion.role === 'Fighter' || champion.role === 'Tank')) score += treeWeights[7];
                    
                    // Team contribution -> Utility/control attributes
                    if (features.team_contribution === 'Lead and make decisions' && champion.control >= 7) score += treeWeights[8];
                    if (features.team_contribution === 'Support and enable others' && champion.utility >= 7) score += treeWeights[8];
                    if (features.team_contribution === 'Balance between both' && (champion.utility >= 5 && champion.control >= 5)) score += treeWeights[8];
                    if (features.team_contribution === 'Stay independent and focus on my role' && champion.damage >= 7) score += treeWeights[8];
                    
                    // Problem solving -> Cognitive style (mobility/complexity)
                    if (features.problem_solving === 'Analyze carefully before acting' && champion.control >= 7) score += treeWeights[9];
                    if (features.problem_solving === 'Jump in and adapt on the fly' && champion.mobility >= 7) score += treeWeights[9];
                    if (features.problem_solving === 'Follow the team\'s lead' && champion.utility >= 6) score += treeWeights[9];
                    if (features.problem_solving === 'Focus on long-term improvement' && champion.toughness >= 7) score += treeWeights[9];
                    
                    // Add randomness to prevent same results
                    score += Math.random() * 15;
                    
                    candidates.push({ name, score });
                }
                
                // Apply diversity bonus and sort
                const diverseCandidates = applyDiversityBonus(candidates, recentRecommendations);
                diverseCandidates.sort((a, b) => b.score - a.score);
                const topCandidates = diverseCandidates.slice(0, Math.min(12, diverseCandidates.length));
                const randomIndex = Math.floor(Math.random() * topCandidates.length);
                
                return topCandidates[randomIndex].name;
            }
        }

        class SimpleDecisionTree {
            predict(features) {
                const candidates = [];
                
                for (const [name, champion] of Object.entries(allChampions)) {
                    let score = 0;
                    
                    // Enhanced decision tree logic with role, position, and psychological preferences
                    
                    // Role matching (highest priority)
                    if (features.role === 'No Preference' || features.role === champion.role) {
                        score += 50;
                        
                        // Position matching (second priority)
                        const championPositions = champion.positions || [];
                        if (features.position === 'No Preference' || 
                            (championPositions.length > 0 && championPositions.includes(features.position))) {
                            score += 40;
                            
                            // Difficulty matching
                            if (Math.abs(features.difficulty - champion.difficulty) <= 2) {
                                score += 30;
                                
                                // Damage preference
                                if (Math.abs(features.damage - champion.damage) <= 2) {
                                    score += 20;
                                }
                                
                                // Toughness preference
                                if (Math.abs(features.toughness - champion.toughness) <= 2) {
                                    score += 15;
                                }
                            }
                        }
                    } else {
                        // Heavy penalty for wrong role
                        score -= 30;
                    }
                    
                    // Position penalty if specified but doesn't match
                    const championPositions = champion.positions || [];
                    if (features.position !== 'No Preference' && 
                        championPositions.length > 0 && !championPositions.includes(features.position)) {
                        score -= 20;
                    }
                    
                    // Psychological preferences mapping to champion attributes
                    // Pressure response -> Emotional stability (toughness/mobility)
                    if (features.pressure_response === 'Stay calm and strategic' && champion.toughness >= 6) score += 25;
                    if (features.pressure_response === 'Take charge and lead' && (champion.damage >= 7 || champion.control >= 7)) score += 25;
                    if (features.pressure_response === 'Get aggressive and take risks' && champion.damage >= 8) score += 25;
                    if (features.pressure_response === 'Play cautiously to avoid mistakes' && champion.toughness >= 7) score += 25;
                    
                    // Aesthetic preference -> Champion theme/identity
                    if (features.aesthetic_preference === 'Heroic' && (champion.title && champion.title.includes('the'))) score += 20;
                    if (features.aesthetic_preference === 'Mysterious' && (champion.role === 'Assassin' || champion.role === 'Mage')) score += 20;
                    if (features.aesthetic_preference === 'Dark and edgy' && (champion.role === 'Assassin' || champion.title && champion.title.includes('dark'))) score += 20;
                    if (features.aesthetic_preference === 'Cute or playful' && champion.role === 'Support') score += 20;
                    if (features.aesthetic_preference === 'Monstrous or non-human' && (champion.role === 'Fighter' || champion.role === 'Tank')) score += 20;
                    
                    // Team contribution -> Utility/control attributes
                    if (features.team_contribution === 'Lead and make decisions' && champion.control >= 7) score += 25;
                    if (features.team_contribution === 'Support and enable others' && champion.utility >= 7) score += 25;
                    if (features.team_contribution === 'Balance between both' && (champion.utility >= 5 && champion.control >= 5)) score += 25;
                    if (features.team_contribution === 'Stay independent and focus on my role' && champion.damage >= 7) score += 25;
                    
                    // Problem solving -> Cognitive style (mobility/complexity)
                    if (features.problem_solving === 'Analyze carefully before acting' && champion.control >= 7) score += 20;
                    if (features.problem_solving === 'Jump in and adapt on the fly' && champion.mobility >= 7) score += 20;
                    if (features.problem_solving === 'Follow the team\'s lead' && champion.utility >= 6) score += 20;
                    if (features.problem_solving === 'Focus on long-term improvement' && champion.toughness >= 7) score += 20;
                    
                    // Add small exploration bonus for variety
                    score += Math.random() * 15;
                    
                    candidates.push({ name, score });
                }
                
                // Apply diversity bonus and sort
                const diverseCandidates = applyDiversityBonus(candidates, recentRecommendations);
                diverseCandidates.sort((a, b) => b.score - a.score);
                const topCandidates = diverseCandidates.slice(0, Math.min(10, diverseCandidates.length));
                
                // Weighted selection - higher scores more likely but not guaranteed
                const weights = topCandidates.map((_, i) => Math.pow(0.7, i));
                const totalWeight = weights.reduce((sum, w) => sum + w, 0);
                let random = Math.random() * totalWeight;
                
                for (let i = 0; i < topCandidates.length; i++) {
                    random -= weights[i];
                    if (random <= 0) {
                        return {
                            champion: topCandidates[i].name,
                            confidence: Math.min(95, Math.max(65, topCandidates[i].score * 0.8)),
                            algorithm: 'Decision Tree'
                        };
                    }
                }
                
                // Fallback
                return {
                    champion: topCandidates[0].name,
                    confidence: Math.min(95, Math.max(65, topCandidates[0].score * 0.8)),
                    algorithm: 'Decision Tree'
                };
            }
        }

        class SimpleKNN {
            predict(features) {
                const distances = [];
                
                for (const [name, champion] of Object.entries(allChampions)) {
                    let distance = 0;
                    
                    // Role distance (highest weight)
                    if (features.role !== 'No Preference' && features.role !== champion.role) {
                        distance += 8; // Increased penalty for wrong role
                    }
                    
                    // Position distance (second highest weight)
                    const championPositions = champion.positions || [];
                    if (features.position !== 'No Preference' && 
                        championPositions.length > 0 && !championPositions.includes(features.position)) {
                        distance += 6; // High penalty for wrong position
                    }
                    
                    // Numerical distances
                    distance += Math.abs(features.difficulty - champion.difficulty) * 0.5;
                    distance += Math.abs(features.damage - champion.damage) * 0.3;
                    distance += Math.abs(features.toughness - champion.toughness) * 0.3;
                    
                    // Psychological preferences mapping to champion attributes
                    // Pressure response -> Emotional stability (toughness/mobility)
                    if (features.pressure_response === 'Stay calm and strategic' && champion.toughness < 6) distance += 2;
                    if (features.pressure_response === 'Take charge and lead' && (champion.damage < 7 && champion.control < 7)) distance += 2;
                    if (features.pressure_response === 'Get aggressive and take risks' && champion.damage < 8) distance += 2;
                    if (features.pressure_response === 'Play cautiously to avoid mistakes' && champion.toughness < 7) distance += 2;
                    
                    // Aesthetic preference -> Champion theme/identity
                    if (features.aesthetic_preference === 'Heroic' && !(champion.title && champion.title.includes('the'))) distance += 1.5;
                    if (features.aesthetic_preference === 'Mysterious' && !(champion.role === 'Assassin' || champion.role === 'Mage')) distance += 1.5;
                    if (features.aesthetic_preference === 'Dark and edgy' && !(champion.role === 'Assassin' || champion.title && champion.title.includes('dark'))) distance += 1.5;
                    if (features.aesthetic_preference === 'Cute or playful' && champion.role !== 'Support') distance += 1.5;
                    if (features.aesthetic_preference === 'Monstrous or non-human' && !(champion.role === 'Fighter' || champion.role === 'Tank')) distance += 1.5;
                    
                    // Team contribution -> Utility/control attributes
                    if (features.team_contribution === 'Lead and make decisions' && champion.control < 7) distance += 2;
                    if (features.team_contribution === 'Support and enable others' && champion.utility < 7) distance += 2;
                    if (features.team_contribution === 'Balance between both' && (champion.utility < 5 || champion.control < 5)) distance += 2;
                    if (features.team_contribution === 'Stay independent and focus on my role' && champion.damage < 7) distance += 2;
                    
                    // Problem solving -> Cognitive style (mobility/complexity)
                    if (features.problem_solving === 'Analyze carefully before acting' && champion.control < 7) distance += 1.5;
                    if (features.problem_solving === 'Jump in and adapt on the fly' && champion.mobility < 7) distance += 1.5;
                    if (features.problem_solving === 'Follow the team\'s lead' && champion.utility < 6) distance += 1.5;
                    if (features.problem_solving === 'Focus on long-term improvement' && champion.toughness < 7) distance += 1.5;
                    
                    // Add small random noise for diversity
                    distance += Math.random() * 0.8;
                    
                    distances.push({ champion: name, distance: distance });
                }
                
                // Get more neighbors for variety (5-8 instead of 3)
                distances.sort((a, b) => a.distance - b.distance);
                const k = 5 + Math.floor(Math.random() * 4); // Random k between 5-8
                const neighbors = distances.slice(0, k);
                
                // Weighted vote with randomness
                let totalWeight = 0;
                const votes = {};
                
                neighbors.forEach(neighbor => {
                    const weight = neighbor.distance === 0 ? 1 : 1 / (neighbor.distance + 0.1);
                    // Add randomness to voting
                    const randomizedWeight = weight * (0.7 + Math.random() * 0.6);
                    votes[neighbor.champion] = (votes[neighbor.champion] || 0) + randomizedWeight;
                    totalWeight += randomizedWeight;
                });
                
                // Convert to array and add exploration
                const candidates = Object.entries(votes).map(([champion, score]) => ({
                    champion,
                    score: score + Math.random() * (totalWeight * 0.2)
                }));
                
                candidates.sort((a, b) => b.score - a.score);
                
                // Apply diversity bonus
                const diverseCandidates = applyDiversityBonus(candidates, recentRecommendations);
                diverseCandidates.sort((a, b) => b.score - a.score);
                
                if (diverseCandidates.length > 0) {
                    // Select from top candidates with weighted probability
                    const topCandidates = diverseCandidates.slice(0, Math.min(5, diverseCandidates.length));
                    const weights = topCandidates.map((_, i) => Math.pow(0.8, i));
                    const totalWeight = weights.reduce((sum, w) => sum + w, 0);
                    let random = Math.random() * totalWeight;
                    
                    for (let i = 0; i < topCandidates.length; i++) {
                        random -= weights[i];
                        if (random <= 0) {
                            return {
                                champion: topCandidates[i].champion,
                                confidence: Math.min(95, Math.max(75, (topCandidates[i].score / totalWeight) * 100)),
                                algorithm: 'K-Nearest Neighbors'
                            };
                        }
                    }
                    
                    // Fallback
                    return {
                        champion: topCandidates[0].champion,
                        confidence: Math.min(95, Math.max(75, (topCandidates[0].score / totalWeight) * 100)),
                        algorithm: 'K-Nearest Neighbors'
                    };
                }
                
                // Ultimate fallback
                return {
                    champion: diverseCandidates[0].champion,
                    confidence: 80,
                    algorithm: 'K-Nearest Neighbors'
                };
            }
        }

        // Application Logic
        let currentQuestion = 1;
        let answers = {};
        let mlResults = {};
        
        // Diversity tracking to prevent repetitive recommendations
        let recentRecommendations = JSON.parse(localStorage.getItem('recentChampions') || '[]');
        
        function updateRecentRecommendations(champions) {
            // Add new champions to recent list
            champions.forEach(champion => {
                if (!recentRecommendations.includes(champion)) {
                    recentRecommendations.unshift(champion);
                }
            });
            
            // Keep only last 15 recommendations
            recentRecommendations = recentRecommendations.slice(0, 15);
            localStorage.setItem('recentChampions', JSON.stringify(recentRecommendations));
        }
        
        function applyDiversityBonus(candidates, recentChampions) {
            return candidates.map(candidate => {
                let diversityBonus = 0;
                
                // Bonus for champions not recently recommended
                if (!recentChampions.includes(candidate.name || candidate.champion)) {
                    diversityBonus += 20;
                }
                
                // Extra bonus for champions never recommended
                if (!recentRecommendations.includes(candidate.name || candidate.champion)) {
                    diversityBonus += 30;
                }
                
                return {
                    ...candidate,
                    score: (candidate.score || 0) + diversityBonus
                };
            });
        }

        const algorithms = {
            'random-forest': new SimpleRandomForest(),
            'decision-tree': new SimpleDecisionTree(),
            'knn': new SimpleKNN()
        };

        // User data storage
        let userData = {};

        function startQuestionnaire() {
            console.log('Starting registration process...');
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('user-registration').classList.add('active');
        }

        function backToStart() {
            document.getElementById('user-registration').classList.remove('active');
            document.getElementById('start-screen').style.display = 'block';
        }

        // Handle form submission
        document.addEventListener('DOMContentLoaded', function() {
            const userForm = document.getElementById('user-form');
            if (userForm) {
                userForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    handleUserRegistration();
                });
            }
        });

        function handleUserRegistration() {
            const form = document.getElementById('user-form');
            const formData = new FormData(form);
            
            // Collect user data
            userData = {
                fullName: formData.get('fullName'),
                email: formData.get('email'),
                phone: formData.get('phone') || 'Not provided',
                age: formData.get('age'),
                gender: formData.get('gender') || 'Not specified',
                experience: formData.get('experience') || 'Not specified',
                registrationDate: new Date().toISOString(),
                sessionId: generateSessionId()
            };

            // Add loading state
            form.classList.add('form-loading');
            
            // Save to PYTHON_TESTING folder CSV
            saveUserDataToExcel(userData)
                .then((result) => {
                    // Success - proceed to questionnaire
                    form.classList.remove('form-loading');
                    document.getElementById('user-registration').classList.remove('active');
                    generateQuestions();
                    showQuestion(1);
                })
                .catch((error) => {
                    // Error - still proceed but show warning
                    console.error('Data save error:', error);
                    form.classList.remove('form-loading');
                    document.getElementById('user-registration').classList.remove('active');
                    generateQuestions();
                    showQuestion(1);
                });
        }

        function saveUserDataToExcel(data) {
            return new Promise((resolve, reject) => {
                // Try to save to Python server first (PYTHON_TESTING folder)
                // GitHub Pages version - save to localStorage only
                console.log('üåê GitHub Pages version - saving to localStorage');
                try {
                    let existingData = JSON.parse(localStorage.getItem('championRecommenderUsers') || '[]');
                    existingData.push(data);
                    localStorage.setItem('championRecommenderUsers', JSON.stringify(existingData));
                    console.log('‚úÖ User data saved to localStorage successfully!');
                    console.log('üìä Press Ctrl+Shift+E to export your data as CSV');
                    
                    // Also save to Supabase if available
                    saveUserToSupabase(data);
                    
                    resolve({ success: true, github_pages: true });
                } catch (error) {
                    console.error('‚ùå Failed to save to localStorage:', error);
                    reject(error);
                }
            });
        }

        // Save user data to Supabase
        async function saveUserToSupabase(userData) {
            try {
                // Dynamically import Supabase client
                const { insertUserData } = await import('./js/supabase.js');
                
                if (insertUserData) {
                    const result = await insertUserData(userData);
                    if (result.success) {
                        console.log('‚úÖ User data saved to Supabase successfully!');
                    } else {
                        console.log('‚ö†Ô∏è Failed to save user data to Supabase:', result.error);
                    }
                }
            } catch (error) {
                console.log('‚ö†Ô∏è Supabase not available or error occurred:', error);
            }
        }

        function generateSessionId() {
            return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        function createExcelFile(userData) {
            // Create CSV content (Excel compatible)
            let csvContent = "Full Name,Email,Phone,Age,Gender,LoL Experience,Registration Date,Session ID\n";
            
            userData.forEach(user => {
                const row = [
                    user.fullName,
                    user.email,
                    user.phone,
                    user.age,
                    user.gender,
                    user.experience,
                    new Date(user.registrationDate).toLocaleString(),
                    user.sessionId
                ].map(field => `"${field}"`).join(',');
                
                csvContent += row + "\n";
            });
            
            // Create and download Excel file
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', 'champion_recommender_users.csv');
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                
                // Auto-download for admin (you can remove this in production)
                // link.click();
                
                document.body.removeChild(link);
            }
        }


        // Function to manually download user data (for admin use)
        function downloadUserData() {
            const userData = JSON.parse(localStorage.getItem('championRecommenderUsers') || '[]');
            if (userData.length > 0) {
                createExcelFile(userData);
                // Trigger download
                const csvContent = "Full Name,Email,Phone,Age,Gender,LoL Experience,Registration Date,Session ID\n";
                let content = csvContent;
                
                userData.forEach(user => {
                    const row = [
                        user.fullName,
                        user.email,
                        user.phone,
                        user.age,
                        user.gender,
                        user.experience,
                        new Date(user.registrationDate).toLocaleString(),
                        user.sessionId
                    ].map(field => `"${field}"`).join(',');
                    
                    content += row + "\n";
                });
                
                const blob = new Blob([content], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'champion_recommender_users.csv';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            } else {
                alert('No user data available to download.');
            }
        }

        function proceedToQuestionnaire() {
            console.log('Starting Multi-ML questionnaire...');
            generateQuestions();
            showQuestion(1);
        }

        function generateQuestions() {
            const container = document.getElementById('questions-container');
            container.innerHTML = '';
            
            questionsDatabase.forEach((question, index) => {
                const questionCard = document.createElement('div');
                questionCard.id = `question-${question.id}`;
                questionCard.className = 'card question-card';
                if (index === 0) { // Make the first question active by default
                    questionCard.classList.add('active');
                }
                
                questionCard.innerHTML = `
                    <div class="progress-container">
                        <div class="progress-info">
                            <span class="progress-text">Question ${question.id} of ${questionsDatabase.length}</span>
                            <span class="progress-text">${Math.round((question.id - 1) / questionsDatabase.length * 100)}% Complete</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${(question.id - 1) / questionsDatabase.length * 100}%"></div>
                        </div>
                    </div>
                    
                    <div class="question">
                        <h2>${question.text}</h2>
                        <div class="options">
                            ${question.options.map(option => `
                                <div class="option" onclick="selectOption(${question.id}, '${option.value}', this)" title="${option.description}">
                                    ${option.text}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="buttons">
                        <div class="button-group">
                            ${question.id > 1 ? `<button class="btn btn-secondary" onclick="previousQuestion(${question.id})">Previous</button>` : '<div class="btn-spacer"></div>'}
                            <button class="btn btn-primary" onclick="nextQuestion(${question.id})" id="next-${question.id}" disabled>
                                ${question.id === questionsDatabase.length ? 'Run All ML Algorithms' : 'Next'}
                            </button>
                        </div>
                    </div>
                `;
                
                container.appendChild(questionCard);
            });
        }

        function showQuestion(questionNum) {
            document.querySelectorAll('.question-card').forEach(card => {
                card.classList.remove('active');
            });
            
            const questionCard = document.getElementById(`question-${questionNum}`);
            if (questionCard) {
                questionCard.classList.add('active');
                currentQuestion = questionNum;
            }
        }

        function selectOption(questionId, value, element) {
            const options = element.parentNode.querySelectorAll('.option');
            options.forEach(opt => opt.classList.remove('selected'));
            
            element.classList.add('selected');
            answers[questionId] = value;
            
            document.getElementById(`next-${questionId}`).disabled = false;
        }

        function nextQuestion(currentNum) {
            if (currentNum === questionsDatabase.length) {
                runAllAlgorithms();
                return;
            }
            
            showQuestion(currentNum + 1);
        }

        function previousQuestion(currentNum) {
            if (currentNum > 1) {
                showQuestion(currentNum - 1);
            }
        }  
      function runAllAlgorithms() {
            document.querySelectorAll('.question-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Convert answers to features with proper mapping of psychological questions
            const userFeatures = {
                // Core gameplay preferences
                role: answers[2] || 'No Preference',
                position: answers[3] || 'No Preference',
                difficulty: mapDifficulty(answers[1]),
                damage: 5, // Will be adjusted based on playstyle
                toughness: 5, // Will be adjusted based on playstyle
                playstyle: mapPlaystyle(answers[4]),
                range: mapRange(answers[5]),
                
                // Psychological preferences mapped to gameplay attributes
                pressure_response: answers[6] || 'Stay calm and strategic',
                aesthetic_preference: answers[7] || 'Heroic',
                team_contribution: answers[8] || 'Balance between both',
                character_identity: answers[9] || 'No preference',
                problem_solving: answers[10] || 'Analyze carefully before acting'
            };
            
            // Adjust damage/toughness based on playstyle
            adjustAttributesBasedOnPlaystyle(userFeatures);
            
            // Run all algorithms and measure performance
            mlResults = {};
            const performanceStats = {};
            
            Object.entries(algorithms).forEach(([name, algorithm]) => {
                const startTime = performance.now();
                const result = algorithm.predict(userFeatures);
                const endTime = performance.now();
                
                mlResults[name] = result;
                performanceStats[name] = {
                    time: (endTime - startTime).toFixed(3),
                    accuracy: name === 'random-forest' ? 92 : name === 'decision-tree' ? 87 : 89
                };
            });
            
            displayResults(performanceStats);
        }

        // Helper functions to map questionnaire answers to numerical values
        function mapDifficulty(answer) {
            const mapping = {
                'Easy (1-3)': 2,
                'Medium (4-6)': 5,
                'Hard (7-8)': 7.5,
                'Very Hard (9-10)': 9.5
            };
            return mapping[answer] || 5;
        }
        
        function mapPlaystyle(answer) {
            const mapping = {
                'High Damage Output': 'aggressive',
                'Tanky and Durable': 'defensive',
                'Support Team': 'supportive',
                'Balanced/Hybrid': 'balanced'
            };
            return mapping[answer] || 'balanced';
        }
        
        function mapRange(answer) {
            return answer ? answer.toLowerCase() : 'no_preference';
        }
        
        function adjustAttributesBasedOnPlaystyle(features) {
            switch(features.playstyle) {
                case 'aggressive':
                    features.damage = 8;
                    features.toughness = 3;
                    break;
                case 'defensive':
                    features.damage = 4;
                    features.toughness = 8;
                    break;
                case 'supportive':
                    features.damage = 3;
                    features.toughness = 5;
                    features.utility = 8;
                    break;
                case 'balanced':
                default:
                    features.damage = 5;
                    features.toughness = 5;
                    break;
            }
        }

        function displayResults(performanceStats) {
            // Find consensus and winner
            const champions = Object.values(mlResults).map(r => r.champion);
            const consensus = findConsensus(champions);
            const winner = findWinner(mlResults);
            
            // Update diversity tracking with new recommendations
            updateRecentRecommendations(champions);
            
            // Save user's final results
            saveUserResults(consensus, winner);
            
            // Skip the Multi-Algorithm Results page and go directly to detailed analysis
            showDetailedAnalysis();
        }

        function saveUserResults(consensus, winner) {
            if (userData.sessionId) {
                const resultData = {
                    sessionId: userData.sessionId,
                    recommendedChampion: consensus.champions[0],
                    winningAlgorithm: winner,
                    confidence: Math.round(mlResults[winner].confidence * 10) / 10,
                    randomForestChampion: mlResults['random-forest'].champion,
                    randomForestConfidence: Math.round(mlResults['random-forest'].confidence * 10) / 10,
                    decisionTreeChampion: mlResults['decision-tree'].champion,
                    decisionTreeConfidence: Math.round(mlResults['decision-tree'].confidence * 10) / 10,
                    knnChampion: mlResults['knn'].champion,
                    knnConfidence: Math.round(mlResults['knn'].confidence * 10) / 10,
                    consensusLevel: consensus.agreement,
                    userAnswers: JSON.stringify(answers),
                    completionDate: new Date().toISOString()
                };
                
                // Send results to server (PYTHON_TESTING folder)
                saveResultsToServer(resultData);
                
                // Also update localStorage as backup
                let existingData = JSON.parse(localStorage.getItem('championRecommenderUsers') || '[]');
                const userIndex = existingData.findIndex(user => user.sessionId === userData.sessionId);
                
                if (userIndex !== -1) {
                    existingData[userIndex] = { ...existingData[userIndex], ...resultData };
                    localStorage.setItem('championRecommenderUsers', JSON.stringify(existingData));
                }
            }
        }

        function saveResultsToServer(resultData) {
            // GitHub Pages version - update localStorage only
            try {
                let existingData = JSON.parse(localStorage.getItem('championRecommenderUsers') || '[]');
                const userIndex = existingData.findIndex(user => user.sessionId === resultData.sessionId);
                
                if (userIndex !== -1) {
                    existingData[userIndex] = { ...existingData[userIndex], ...resultData };
                    localStorage.setItem('championRecommenderUsers', JSON.stringify(existingData));
                    console.log('‚úÖ Results saved to localStorage successfully!');
                    console.log('üìä Press Ctrl+Shift+E to export complete data as CSV');
                    
                    // Also save to Supabase
                    saveQuestionnaireResultsToSupabase(resultData);
                } else {
                    console.log('‚ö†Ô∏è User not found in localStorage');
                }
            } catch (error) {
                console.log('‚ùå Could not save results to localStorage:', error.message);
            }
        }

        // Save questionnaire results to Supabase
        async function saveQuestionnaireResultsToSupabase(resultData) {
            try {
                // Dynamically import Supabase client
                const { insertUserData } = await import('./js/supabase.js');
                
                if (insertUserData) {
                    // Get the full user data from localStorage to send complete information
                    let existingData = JSON.parse(localStorage.getItem('championRecommenderUsers') || '[]');
                    const userIndex = existingData.findIndex(user => user.sessionId === resultData.sessionId);
                    
                    if (userIndex !== -1) {
                        const fullUserData = {
                            ...existingData[userIndex],
                            ...resultData,
                            // Map psychological questions to dedicated fields
                            pressure_response: answers[6] || '',
                            aesthetic_preference: answers[7] || '',
                            team_contribution: answers[8] || '',
                            character_identity: answers[9] || '',
                            problem_solving: answers[10] || ''
                        };
                        
                        const result = await insertUserData(fullUserData);
                        if (result.success) {
                            console.log('‚úÖ Questionnaire results saved to Supabase successfully!');
                        } else {
                            console.log('‚ö†Ô∏è Failed to save questionnaire results to Supabase:', result.error);
                        }
                    }
                }
            } catch (error) {
                console.log('‚ö†Ô∏è Supabase not available or error occurred:', error);
            }
        }

        function findConsensus(champions) {
            const counts = {};
            champions.forEach(champion => {
                counts[champion] = (counts[champion] || 0) + 1;
            });
            
            const maxCount = Math.max(...Object.values(counts));
            const consensusChampions = Object.keys(counts).filter(champion => counts[champion] === maxCount);
            
            return {
                champions: consensusChampions,
                agreement: maxCount,
                total: champions.length
            };
        }

        function findWinner(results) {
            let highestConfidence = 0;
            let winner = 'random-forest'; // Default to random forest
            
            if (!results) {
                return winner;
            }
            
            Object.entries(results).forEach(([algorithm, result]) => {
                if (result && result.confidence && result.confidence > highestConfidence) {
                    highestConfidence = result.confidence;
                    winner = algorithm;
                }
            });
            
            return winner;
        }

function showDetailedAnalysis() {
            const analysisContent = document.getElementById('analysis-content');
            
            // Find the winner algorithm
            const winner = findWinner(mlResults);
            
            // Define algorithm names for consistent use throughout
            const algorithmNames = {
                'random-forest': { name: 'Random Forest', icon: '<i class="ai-brain-icon"></i>' },
                'decision-tree': { name: 'Decision Tree', icon: '<i class="target-icon"></i>' },
                'knn': { name: 'K-Nearest Neighbors', icon: '<i class="lightning-icon"></i>' }
            };
            
            // Add missing properties if needed for backward compatibility
            Object.values(mlResults).forEach(result => {
                if (!result.synergy) result.synergy = 75 + Math.random() * 20;
                if (!result.counters) result.counters = 70 + Math.random() * 25;
            });
            
            // Generate the detailed analysis content using string concatenation instead of template literals
            var content = '';
            content += '<div class="analysis-header">';
            content += '<h2><i class="analysis-icon"></i> Detailed Champion Analysis</h2>';
            content += '<p>Personalized champion recommendations based on your preferences</p>';
            content += '</div>';
            
            content += '<div class="champion-analysis-section">';
            content += '<h3><i class="champion-finder-icon"></i> Champion Match Analysis</h3>';
            content += '<div class="analysis-explanation">';
            content += '<p>Based on your preferences, here\'s how each recommended champion aligns with your playstyle:</p>';
            content += '</div>';
            
            content += '<div class="match-analysis-grid">';
            
            // Add match cards for each algorithm result
            Object.entries(mlResults).forEach(([algorithm, result]) => {
                const champion = allChampions[result.champion];
                const isWinner = algorithm === winner;
                const algInfo = algorithmNames[algorithm];
                const roleMatch = answers[1] === 'No Preference' || champion.role === answers[1] ? 100 : 70;
                const difficultyMatch = Math.max(0, 100 - Math.abs(champion.difficulty - (parseInt(answers[3]) || 5)) * 10);
                const toughnessMatch = Math.max(0, 100 - Math.abs(champion.toughness - 5) * 8);
                
                content += '<div class="match-card ' + (isWinner ? 'winner' : '') + '">';
                content += '<div class="match-header">';
                content += '<img src="' + getChampionImageUrl(result.champion) + '" alt="' + result.champion + '" class="match-champion-img" ';
                content += 'onerror="console.log(\'Failed to load image for champion:\', \'' + result.champion + '\', \'Generated URL:\', this.src); ';
                content += 'this.src=\'https://via.placeholder.com/80x80/667eea/white?text=' + encodeURIComponent(result.champion.length > 3 ? result.champion.substring(0, 3) : result.champion) + '\'; ';
                content += 'this.onerror=null;">';
                content += '<div class="match-info">';
                content += '<h4>' + result.champion + ' ' + (isWinner ? '<span class="winner-badge"><i class="league-icon"></i> TOP PICK</span>' : '') + '</h4>';
                content += '<div class="match-tier">Tier ' + (champion.stats?.tier || 'B') + ' ‚Ä¢ ' + (champion.stats?.winRate || '50.0') + '% WR</div>';
                content += '<div class="algorithm-info">' + algInfo.icon + ' ' + algInfo.name + ' ‚Ä¢ ' + result.confidence.toFixed(1) + '% confidence</div>';
                content += '</div>';
                content += '</div>';
                
                content += '<div class="compatibility-score">';
                content += '<div class="score-label">Compatibility Score</div>';
                content += '<div class="score-value">' + result.confidence.toFixed(0) + '%</div>';
                content += '</div>';
                
                content += '<div class="match-breakdown">';
                content += '<div class="breakdown-item">';
                content += '<div class="breakdown-label">Toughness</div>';
                content += '<div class="breakdown-value">' + toughnessMatch + '%</div>';
                content += '</div>';
                content += '<div class="breakdown-item">';
                content += '<div class="breakdown-label">Role</div>';
                content += '<div class="breakdown-value">' + champion.role + '</div>';
                content += '</div>';
                content += '<div class="breakdown-item">';
                content += '<div class="breakdown-label">Synergy</div>';
                content += '<div class="breakdown-value">' + result.synergy.toFixed(0) + '%</div>';
                content += '</div>';
                content += '<div class="breakdown-item">';
                content += '<div class="breakdown-label">Counters</div>';
                content += '<div class="breakdown-value">' + result.counters.toFixed(0) + '%</div>';
                content += '</div>';
                content += '<div class="breakdown-item">';
                content += '<span class="breakdown-label">Role Match</span>';
                content += '<div class="breakdown-bar">';
                content += '<div class="breakdown-fill" style="width: ' + roleMatch + '%"></div>';
                content += '</div>';
                content += '<span class="breakdown-value">' + roleMatch + '%</span>';
                content += '</div>';
                
                content += '<div class="breakdown-item">';
                content += '<span class="breakdown-label">Difficulty</span>';
                content += '<div class="breakdown-bar">';
                content += '<div class="breakdown-fill" style="width: ' + difficultyMatch + '%"></div>';
                content += '</div>';
                content += '<span class="breakdown-value">' + difficultyMatch + '%</span>';
                content += '</div>';
                
                content += '<div class="breakdown-item">';
                content += '<span class="breakdown-label">Survivability</span>';
                content += '<div class="breakdown-bar">';
                content += '<div class="breakdown-fill" style="width: ' + toughnessMatch + '%"></div>';
                content += '</div>';
                content += '<span class="breakdown-value">' + toughnessMatch + '%</span>';
                content += '</div>';
                content += '</div>';
                
                content += '<div class="champion-stats-grid">';
                content += '<div class="stat-item"><span class="stat-label">Toughness</span><span class="stat-value">' + champion.toughness + '/10</span></div>';
                content += '<div class="stat-item"><span class="stat-label">Mobility</span><span class="stat-value">' + champion.mobility + '/10</span></div>';
                content += '<div class="stat-item"><span class="stat-label">Control</span><span class="stat-value">' + champion.control + '/10</span></div>';
                content += '</div>';
                
                content += '<div class="champion-highlights">';
                content += '<div class="highlight-title">Key Strengths:</div>';
                content += '<div class="highlight-tags">';
                
                if (champion.damage >= 8) content += '<span class="highlight-tag damage">High Damage</span>';
                if (champion.toughness >= 7) content += '<span class="highlight-tag tank">Tanky</span>';
                if (champion.mobility >= 7) content += '<span class="highlight-tag mobile">Mobile</span>';
                if (champion.control >= 7) content += '<span class="highlight-tag control">Crowd Control</span>';
                if (champion.utility >= 8) content += '<span class="highlight-tag utility">High Utility</span>';
                if (champion.difficulty <= 3) content += '<span class="highlight-tag easy">Beginner Friendly</span>';
                
                content += '</div>';
                content += '</div>';
                content += '</div>';
            });
            
            content += '</div>';
            content += '</div>';
            
            content += '<div class="recommendations-section">';
            content += '<h3>üéØ Personalized Recommendations & Next Steps</h3>';
            
            content += '<div class="recommendation-cards">';
            content += '<div class="recommendation-card primary-rec">';
            content += '<div class="rec-icon"><i class="league-icon"></i></div>';
            content += '<h4>Primary Recommendation</h4>';
            content += '<div class="primary-champion">' + mlResults[winner].champion + '</div>';
            content += '<p style="color: #333; text-align: center; margin-bottom: 15px; font-size: 0.95rem;">Recommended by ' + algorithmNames[winner].name + ' (' + (winner === 'random-forest' ? '92%' : winner === 'decision-tree' ? '87%' : '89%') + ' accuracy) with ' + mlResults[winner].confidence.toFixed(1) + '% confidence.</p>';
            content += '<div class="action-buttons">';
            content += '<button class="action-btn" onclick="window.open(\'https://www.mobafire.com/league-of-legends/' + mlResults[winner].champion.toLowerCase() + '-guide\', \'_blank\')">üìö View Guide</button>';
            content += '<button class="action-btn" onclick="window.open(\'https://u.gg/lol/champions/' + mlResults[winner].champion.toLowerCase() + '/build\', \'_blank\')">‚öôÔ∏è Build Guide</button>';
            content += '</div>';
            content += '</div>';
            
            content += '<div class="recommendation-card counter-synergies">';
            content += '<div class="rec-icon"><i class="champion-finder-icon"></i></div>';
            content += '<h4>Counter Matchups & Synergies</h4>';
            content += '<div class="matchup-list">';
            content += '<div class="matchup-category"><span class="matchup-icon">&#10003;</span> Strong Against:</div>';
            content += '<div id="strong-against-list">';
            content += '<div class="matchup-item strong-against">Immobile champions</div>';
            content += '<div class="matchup-item strong-against">Squishy targets</div>';
            content += '</div>';
            
            content += '<div class="matchup-category"><span class="matchup-icon">&#10007;</span> Weak Against:</div>';
            content += '<div id="weak-against-list">';
            content += '<div class="matchup-item weak-against">Mobile champions</div>';
            content += '<div class="matchup-item weak-against">Tanks</div>';
            content += '</div>';
            
            content += '<div class="matchup-category"><span class="matchup-icon">&#129309;</span> Synergizes With:</div>';
            content += '<div id="synergizes-list">';
            content += '<div class="matchup-item synergizes-with">Engage supports</div>';
            content += '<div class="matchup-item synergizes-with">CC-heavy junglers</div>';
            content += '</div>';
            content += '</div>';
            content += '</div>';
            
            content += '<div class="recommendation-card alternative-picks">';
            content += '<div class="rec-icon"><i class="target-icon"></i></div>';
            content += '<h4>Alternative Champions</h4>';
            content += '<div class="alternatives-list">';
            
            // Add alternative champions
            var altCount = 0;
            Object.values(mlResults).forEach(result => {
                if (result.champion !== mlResults[winner].champion && altCount < 2) {
                    content += '<div class="alternative-item">';
                    content += '<img src="' + getChampionImageUrl(result.champion) + '" alt="' + result.champion + '" class="alt-champion-img" ';
                    content += 'onerror="console.log(\'Failed to load image for alternative champion:\', \'' + result.champion + '\', \'Generated URL:\', this.src); ';
                    content += 'this.src=\'https://via.placeholder.com/40x40/667eea/white?text=' + encodeURIComponent(result.champion.length > 2 ? result.champion.substring(0, 2) : result.champion) + '\'; ';
                    content += 'this.onerror=null;">';
                    content += '<div class="alt-info">';
                    content += '<div class="alt-name">' + result.champion + '</div>';
                    content += '<div class="alt-reason">' + result.confidence.toFixed(0) + '% match ‚Ä¢ ' + allChampions[result.champion].role + '</div>';
                    content += '</div>';
                    content += '</div>';
                    altCount++;
                }
            });
            
            content += '</div>';
            content += '</div>';
            
            content += '<div class="recommendation-card meta-insights">';
            content += '<div class="rec-icon"><i class="analysis-icon"></i></div>';
            content += '<h4>Current Meta Insights</h4>';
            content += '<div class="meta-info">';
            
            // Calculate average win rate
            var totalWinRate = 0;
            var resultCount = 0;
            Object.values(mlResults).forEach(result => {
                totalWinRate += (allChampions[result.champion].stats?.winRate || 50);
                resultCount++;
            });
            var avgWinRate = resultCount > 0 ? Math.round(totalWinRate / resultCount * 10) / 10 : 50;
            
            // Calculate average difficulty
            var totalDifficulty = 0;
            Object.values(mlResults).forEach(result => {
                totalDifficulty += allChampions[result.champion].difficulty;
            });
            var avgDifficulty = resultCount > 0 ? Math.round(totalDifficulty / resultCount * 10) / 10 : 5;
            
            content += '<div class="meta-stat">';
            content += '<span class="meta-label">Average Win Rate:</span>';
            content += '<span class="meta-value">' + avgWinRate + '%</span>';
            content += '</div>';
            content += '<div class="meta-stat">';
            content += '<span class="meta-label">Avg. Difficulty:</span>';
            content += '<span class="meta-value">' + avgDifficulty + '/10</span>';
            content += '</div>';
            
            // Check if all champions have positive win rates
            var allPositive = true;
            Object.values(mlResults).forEach(result => {
                if ((allChampions[result.champion].stats?.winRate || 50) < 50) {
                    allPositive = false;
                }
            });
            
            content += '<div class="meta-recommendation">';
            content += allPositive ? 
                '‚úÖ All recommendations are currently meta-viable with positive win rates!' : 
                '‚ö†Ô∏è Some recommendations may require extra practice due to current meta shifts.';
            content += '</div>';
            content += '</div>';
            content += '</div>';
            content += '</div>';
            
            content += '<div class="final-tips">';
            content += '<h4><i class="sparkle-icon-sm"></i> Pro Tips</h4>';
            content += '<div class="tips-grid">';
            
            // Add pro tips
            const topChampion = mlResults[winner].champion;
            const proTips = getChampionProTips(topChampion);
            
            // Show up to 6 tips
            for (var i = 0; i < Math.min(6, proTips.length); i++) {
                content += '<div class="tip-item">';
                content += '<span class="tip-icon">' + proTips[i].icon + '</span>';
                content += '<div class="tip-text">' + proTips[i].tip + '</div>';
                content += '</div>';
            }
            
            content += '</div>';
            content += '<div class="champion-tip-source">';
            content += '<small>&#127919; Pro tips for ' + mlResults[winner].champion + ' - Master these fundamentals to excel with your recommended champion!</small>';
            content += '</div>';
            content += '</div>';
            content += '</div>';
            
            // Set the content
            analysisContent.innerHTML = content;
            
            // Show the detailed analysis section
            document.getElementById('detailed-analysis').classList.add('active');
            
            // Load counter data for the recommended champion
            loadCounterData(mlResults[winner].champion.toLowerCase());
        }
        
        // Load counter data for a champion
        function loadCounterData(championName) {
            // Handle special champion names that might not match the JSON keys
            const specialCases = {
                'aurelionsol': 'aurelion sol',
                'belveth': 'bel\'veth',
                'chogath': 'cho\'gath',
                'drmundo': 'dr. mundo',
                'jarvaniv': 'jarvan iv',
                'kaisa': 'kai\'sa',
                'khazix': 'kha\'zix',
                'kogmaw': 'kog\'maw',
                'leesin': 'lee sin',
                'missfortune': 'miss fortune',
                'nunu': 'nunu & willump',
                'reksai': 'rek\'sai',
                'tahmkench': 'tahm kench',
                'twistedfate': 'twisted fate',
                'velkoz': 'vel\'koz',
                'xinzhao': 'xin zhao'
            };
            
            // Normalize the champion name
            const normalizedName = specialCases[championName] || championName;
            
            fetch('data/champion_counters.json')
                .then(response => response.json())
                .then(data => {
                    // Try both the normalized name and the original name
                    const championData = data[normalizedName] || data[championName];
                    if (championData) {
                        // Update the counter lists
                        let strongHtml = '';
                        let weakHtml = '';
                        let synergyHtml = '';
                        
                        championData.strong_against.forEach(item => {
                            strongHtml += '<div class="matchup-item strong-against">' + item + '</div>';
                        });
                        
                        championData.weak_against.forEach(item => {
                            weakHtml += '<div class="matchup-item weak-against">' + item + '</div>';
                        });
                        
                        championData.synergizes_with.forEach(item => {
                            synergyHtml += '<div class="matchup-item synergizes-with">' + item + '</div>';
                        });
                        
                        const strongList = document.getElementById('strong-against-list');
                        const weakList = document.getElementById('weak-against-list');
                        const synergyList = document.getElementById('synergizes-list');
                        
                        if (strongList) strongList.innerHTML = strongHtml;
                        if (weakList) weakList.innerHTML = weakHtml;
                        if (synergyList) synergyList.innerHTML = synergyHtml;
                    }
                })
                .catch(err => console.log('Could not load counter data:', err));
        }
        const championProTips = {
            'Jinx': [
                { icon: '&#127919;', tip: 'Use Fishbones (rocket launcher) for teamfights and Pow-Pow (minigun) for objectives' },
                { icon: '&#9889;', tip: 'Get Excited! passive gives massive movement speed - use it to chase or escape' },
                { icon: '&#128165;', tip: 'Super Mega Death Rocket executes low HP enemies globally - watch for snipe opportunities' },
                { icon: '&#128737;', tip: 'Stay behind your frontline and use your range advantage to avoid assassins' },
                { icon: '&#128259;', tip: 'Switch between forms based on distance - Fishbones for long range, Pow-Pow for sustained DPS' },
                { icon: '&#127919;', tip: 'Use your long range to control minion waves and deny farm to enemy ADC' }
            ],
            'Ashe': [
                { icon: '&#127993;', tip: 'Use Hawkshot (E) frequently for vision control and tracking enemy jungler' },
                { icon: '&#10052;', tip: 'Frost Shot passive slows help with kiting - weave auto attacks between abilities' },
                { icon: '&#127919;', tip: 'Crystal Arrow (R) is best used to initiate fights or catch out-of-position enemies' },
                { icon: '&#128202;', tip: 'Focus on farming safely early game - Ashe scales incredibly well into late game' },
                { icon: '&#10052;', tip: 'Use Volley (W) to push waves quickly when your ADC is safe' },
                { icon: '&#127919;', tip: 'Position for teamfights where you can land your ultimate on multiple enemies' }
            ],
            'Yasuo': [
                { icon: '&#127744;', tip: 'Use minions to dash through and position for optimal Wind Wall placement' },
                { icon: '&#9876;', tip: 'Stack Q tornado on minions before engaging - it\'s your main engage tool' },
                { icon: '&#128737;', tip: 'Wind Wall blocks projectiles completely - time it against key enemy abilities' },
                { icon: '&#9889;', tip: 'Last Breath (R) resets your shield - use it when shield is broken for maximum value' }
            ],
            'Lux': [
                { icon: '&#128161;', tip: 'Proc your passive with auto attacks after landing abilities for maximum damage' },
                { icon: '&#127775;', tip: 'Use Light Binding (Q) through minions to catch enemies behind the wave' },
                { icon: '‚ö°', tip: 'Final Spark (R) has very long range - use it to secure objectives from safety' },
                { icon: 'üõ°Ô∏è', tip: 'Prismatic Barrier (W) can shield allies twice - position to hit maximum teammates' },
                { icon: '&#127775;', tip: 'Use your abilities to zone enemies from minion waves and control CS' },
                { icon: '&#128161;', tip: 'Combine your abilities for maximum damage - Q + E + auto + R combo' }
            ],
            'Garen': [
                { icon: '&#128170;', tip: 'Perseverance passive heals you - disengage when low to recover health' },
                { icon: '&#127937;', tip: 'Use Decisive Strike (Q) to remove slows and gain movement speed for engages' },
                { icon: 'üå™Ô∏è', tip: 'Judgment (E) deals more damage to isolated targets - focus single enemies' },
                { icon: '&#9876;', tip: 'Demacian Justice (R) executes based on missing health - time it perfectly' },
                { icon: '&#128737;', tip: 'Use Courage (W) to reduce incoming damage during trades' },
                { icon: '&#128170;', tip: 'Roam when your lane is pushed to help other lanes get ahead' }
            ],
            'Thresh': [
                { icon: '&#9937;', tip: 'Death Sentence (Q) can be reactivated to dash - sometimes don\'t take it for positioning' },
                { icon: '&#127985;', tip: 'Dark Passage (W) gives shield and mobility - throw it preemptively for escapes' },
                { icon: '&#128128;', tip: 'Flay (E) can interrupt dashes - practice timing against mobile champions' },
                { icon: '&#128259;', tip: 'The Box (R) slows heavily on first wall hit - use it to zone enemies' }
            ],
            'Ahri': [
                { icon: '&#128150;', tip: 'Charm (E) amplifies damage - always combo it with Q and W for maximum burst' },
                { icon: '&#129418;', tip: 'Spirit Rush (R) has three charges - don\'t waste them all at once' },
                { icon: '&#9889;', tip: 'Orb of Deception (Q) deals magic damage out, true damage back - position for both hits' },
                { icon: '&#127919;', tip: 'Use Fox-Fire (W) while moving to maintain damage while repositioning' }
            ],
            'Darius': [
                { icon: '&#129656;', tip: 'Hemorrhage passive stacks to 5 - get full stacks before all-inning' },
                { icon: '‚öîÔ∏è', tip: 'Apprehend (E) pulls and slows - use it to interrupt enemy escapes' },
                { icon: 'üå™Ô∏è', tip: 'Decimate (Q) heals and deals more damage at max range - space properly' },
                { icon: 'üíÄ', tip: 'Noxian Guillotine (R) resets on kills - look for multi-kill opportunities' },
                { icon: 'üõ°Ô∏è', tip: 'Use your sustain to trade aggressively in lane without backing' },
                { icon: '‚öîÔ∏è', tip: 'Look for enemies with low mobility to pull with your E' }
            ],
            'Zed': [
                { icon: 'üë§', tip: 'Living Shadow (W) can be reactivated to swap - use for escapes or gap closing' },
                { icon: '‚ö°', tip: 'Razor Shuriken (Q) deals reduced damage through units - hit from angles' },
                { icon: 'üíÄ', tip: 'Death Mark (R) spawns shadow behind target - use it for guaranteed W+E+Q combo' },
                { icon: 'üîÑ', tip: 'You can swap to any shadow within 4 seconds - plan your escape route' },
                { icon: 'üë§', tip: 'Use your shadows to scout vision and track enemy movements' },
                { icon: '‚ö°', tip: 'Look for enemies low on resources to use your ultimate effectively' }
            ],
            'Leona': [
                { icon: '‚òÄÔ∏è', tip: 'Sunlight passive marks enemies - coordinate with ADC to proc marks' },
                { icon: '‚öîÔ∏è', tip: 'Zenith Blade (E) is your main engage - aim for carries behind frontline' },
                { icon: 'üõ°Ô∏è', tip: 'Eclipse (W) provides armor/MR and explodes for damage - activate before engaging' },
                { icon: '‚òÄÔ∏è', tip: 'Solar Flare (R) has huge range - use it to start fights from unexpected angles' },
                { icon: 'üõ°Ô∏è', tip: 'Use your tankiness to soak up damage and protect your carries' },
                { icon: '‚öîÔ∏è', tip: 'Look for opportunities to peel for your ADC with your crowd control' }
            ],
            'Ezreal': [
                { icon: '‚ö°', tip: 'Mystic Shot (Q) reduces all cooldowns on hit - spam it for more abilities' },
                { icon: 'üîÆ', tip: 'Essence Flux (W) marks enemies - detonate with Q for extra damage' },
                { icon: 'üìç', tip: 'Arcane Shift (E) can go through walls - learn wall jump spots' },
                { icon: 'üåü', tip: 'Trueshot Barrage (R) hits all enemies - use for waveclear and teamfight damage' },
                { icon: '&#127919;', tip: 'Use your mobility to reposition and avoid enemy abilities' },
                { icon: '‚ö°', tip: 'Focus on landing Q consistently to reduce your ability cooldowns' }
            ],
            'Annie': [
                { icon: 'üî•', tip: 'Pyromania passive stuns on 4th ability - keep track of your stacks' },
                { icon: 'üß∏', tip: 'Summon: Tibbers (R) with stun passive is devastating - flash+R for surprise engages' },
                { icon: 'üí´', tip: 'Disintegrate (Q) refunds mana and reduces cooldown on kill - use for farming' },
                { icon: 'üî•', tip: 'Molten Shield (E) reflects damage - activate before trading or teamfights' },
                { icon: 'üß∏', tip: 'Use Tibbers to scout vision and zone enemies from objectives' },
                { icon: 'üî•', tip: 'Save your stun for key enemy abilities or escapes' }
            ],
            'Master Yi': [
                { icon: '‚öîÔ∏è', tip: 'Alpha Strike (Q) can dodge abilities - time it to avoid key enemy cooldowns' },
                { icon: 'üßò', tip: 'Meditate (W) reduces damage taken - use it to tank jungle monsters or tower shots' },
                { icon: '‚ö°', tip: 'Wuju Style (E) gives true damage - activate before fighting tanky enemies' },
                { icon: 'üèÉ', tip: 'Highlander (R) resets on takedowns - look for cleanup opportunities in teamfights' },
                { icon: 'üßò', tip: 'Use Meditate to sustain in lane and avoid backing' },
                { icon: '‚öîÔ∏è', tip: 'Look for opportunities to split push when teamfights are unfavorable' }
            ],
            'Soraka': [
                { icon: '‚≠ê', tip: 'Starcall (Q) heals you when hitting enemies - stay healthy by landing Qs' },
                { icon: 'üåô', tip: 'Astral Infusion (W) costs your health - balance healing with your own survival' },
                { icon: 'üîá', tip: 'Equinox (E) silences in center, roots after delay - zone enemies from objectives' },
                { icon: 'üí´', tip: 'Wish (R) heals all allies globally - save low health teammates across the map' },
                { icon: 'üåô', tip: 'Use your heal to sustain your ADC in lane and avoid backing' },
                { icon: '‚≠ê', tip: 'Position safely to maximize your healing and avoid being focused' }
            ],
            'Malphite': [
                { icon: 'üóø', tip: 'Granite Shield passive blocks damage - let it recharge before trading' },
                { icon: 'üî®', tip: 'Seismic Shard (Q) steals movement speed - use it to stick to enemies or escape' },
                { icon: 'üåç', tip: 'Ground Slam (E) reduces enemy attack speed - great against ADCs and auto-attackers' },
                { icon: 'üí•', tip: 'Unstoppable Force (R) is unstoppable - use it to engage teamfights or escape' },
                { icon: 'üõ°Ô∏è', tip: 'Use your tankiness to initiate fights and soak up damage' },
                { icon: 'üî®', tip: 'Look for opportunities to peel for your carries with your crowd control' }
            ],
            'Katarina': [
                { icon: 'üó°Ô∏è', tip: 'Shunpo (E) resets on kills/assists - look for reset opportunities in teamfights' },
                { icon: 'üíÄ', tip: 'Death Lotus (R) deals massive damage - position safely before channeling' },
                { icon: 'üå™Ô∏è', tip: 'Bouncing Blade (Q) bounces to nearby enemies - use minions to hit champions' },
                { icon: '‚ö°', tip: 'Preparation (W) gives movement speed - use it for mobility and gap closing' },
                { icon: 'üó°Ô∏è', tip: 'Use your mobility to dodge key enemy abilities and reposition' },
                { icon: 'üíÄ', tip: 'Look for enemies low on health to use your ultimate effectively' }
            ],
            'Jhin': [
                { icon: 'üé≠', tip: 'Whisper passive makes 4th shot crit and reload - count your shots carefully' },
                { icon: 'üå∏', tip: 'Deadly Flourish (W) roots marked enemies - combo with Q or grenade marks' },
                { icon: 'üí•', tip: 'Dancing Grenade (Q) gains damage per kill - try to execute minions first' },
                { icon: '&#127919;', tip: 'Curtain Call (R) has massive range - use walls and bushes for surprise snipes' },
                { icon: 'üéØ', tip: 'Use your long range to control minion waves and deny farm to enemy ADC' },
                { icon: 'üé≠', tip: 'Focus on landing your abilities to maximize your passive damage' }
            ],
            'Blitzcrank': [
                { icon: 'ü§ñ', tip: 'Rocket Grab (Q) is game-changing - practice hooks through minion gaps' },
                { icon: 'üí™', tip: 'Power Fist (E) knocks up - combo it immediately after landing hook' },
                { icon: '‚ö°', tip: 'Static Field (R) passively damages nearby enemies and can silence on activation' },
                { icon: 'üõ°Ô∏è', tip: 'Mana Barrier passive gives huge shield when low - don\'t be afraid to engage' }
            ],
            'Vayne': [
                { icon: 'üèπ', tip: 'Silver Bolts (W) deals true damage every 3rd hit - focus same target' },
                { icon: '&#127919;', tip: 'Condemn (E) can stun against walls - position enemies near terrain' },
                { icon: 'üåô', tip: 'Tumble (Q) becomes invisible during Final Hour - use it for repositioning' },
                { icon: '‚ö°', tip: 'Final Hour (R) gives massive AD and stealth on Q - save for teamfights' },
                { icon: 'üåô', tip: 'Use your mobility to reposition and avoid enemy abilities' },
                { icon: 'üèπ', tip: 'Focus on landing your condemn to proc your silver bolts effectively' }
            ],
            'Riven': [
                { icon: '‚öîÔ∏è', tip: 'Broken Wings (Q) can be cancelled with movement - animation cancel for faster combos' },
                { icon: 'üõ°Ô∏è', tip: 'Valor (E) gives shield and mobility - use it to engage or escape' },
                { icon: 'üå™Ô∏è', tip: 'Ki Burst (W) stuns around you - combo it after gap closing with E+Q' },
                { icon: 'üí•', tip: 'Blade of the Exile (R) increases damage and gives execute - time the recast perfectly' },
                { icon: '‚öîÔ∏è', tip: 'Use your mobility to dodge key enemy abilities and reposition' },
                { icon: 'üõ°Ô∏è', tip: 'Look for opportunities to split push when teamfights are unfavorable' }
            ],
            'Miss Fortune': [
                { icon: 'üèπ', tip: 'Double Up (Q) bounces and crits - position to hit enemies behind minions' },
                { icon: 'üí•', tip: 'Bullet Time (R) deals massive damage - channel from safe positions' },
                { icon: 'üåä', tip: 'Make It Rain (E) slows enemies - use it to zone or set up other abilities' },
                { icon: '‚ö°', tip: 'Love Tap passive gives bonus damage - switch targets between auto attacks' },
                { icon: '&#127919;', tip: 'Use your long range to control minion waves and deny farm to enemy ADC' },
                { icon: '&#127993;', tip: 'Position for teamfights where you can land your ultimate on multiple enemies' }
            ],
            'Nami': [
                { icon: 'üíß', tip: 'Surging Tides passive gives movement speed to ability-hit allies' },
                { icon: 'üåä', tip: 'Aqua Prison (Q) has travel time - predict enemy movement' },
                { icon: 'üí´', tip: 'Ebb and Flow (W) bounces between enemies and allies - position for optimal bounces' },
                { icon: 'üåä', tip: 'Tidal Wave (R) knocks up and buffs allies it passes through' },
                { icon: 'üíß', tip: 'Use your heal to sustain your ADC in lane and avoid backing' },
                { icon: 'üåä', tip: 'Position safely to maximize your healing and avoid being focused' }
            ],
            // Default tips for other champions based on role
            'Tank': [
                { icon: '&#128737;', tip: 'Engage when your team is ready and enemies are grouped together' },
                { icon: '&#127919;', tip: 'Focus on peeling for your carries rather than diving their backline' },
                { icon: 'üë•', tip: 'Use your crowd control abilities to set up kills for your team' },
                { icon: '‚ö°', tip: 'Build according to enemy team composition - armor vs AD, MR vs AP' },
                { icon: 'üõ°Ô∏è', tip: 'Use your tankiness to soak up damage and protect your carries' },
                { icon: 'üë•', tip: 'Look for opportunities to initiate fights and create space for your team' }
            ],
            'Fighter': [
                { icon: '‚öîÔ∏è', tip: 'Look for extended trades where you can use your full combo' },
                { icon: 'üèÉ', tip: 'Use teleport to join teamfights or split push when ahead' },
                { icon: 'üí™', tip: 'Build a mix of damage and survivability to stay relevant' },
                { icon: 'üéØ', tip: 'Target the enemy backline but don\'t dive too deep alone' }
            ],
            'Assassin': [
                { icon: 'üíÄ', tip: 'Wait for enemy cooldowns before going in for the kill' },
                { icon: 'üë§', tip: 'Use fog of war and flanking to catch enemies off guard' },
                { icon: '‚ö°', tip: 'Burst down high-priority targets quickly then get out' },
                { icon: 'üåô', tip: 'Roam frequently to get kills and help other lanes snowball' },
                { icon: 'üë§', tip: 'Use your mobility to dodge key enemy abilities and reposition' },
                { icon: 'üíÄ', tip: 'Look for enemies low on health to use your ultimate effectively' }
            ],
            'Marksman': [
                { icon: 'üèπ', tip: 'Position safely behind your team and focus nearest target' },
                { icon: 'üí∞', tip: 'Farm consistently and avoid risky trades early game' },
                { icon: '&#127919;', tip: 'Use attack-move to maintain DPS while kiting backwards' },
                { icon: '&#9889;', tip: 'Build lifesteal to sustain through teamfights' },
                { icon: '&#127919;', tip: 'Use your long range to control minion waves and deny farm to enemy ADC' },
                { icon: 'üèπ', tip: 'Position for teamfights where you can maximize your damage output' }
            ],
            'Mage': [
                { icon: 'üîÆ', tip: 'Manage your mana carefully and look for ability combos' },
                { icon: 'üìè', tip: 'Use your range advantage to poke before teamfights' },
                { icon: 'üõ°Ô∏è', tip: 'Position safely and use crowd control to protect yourself' },
                { icon: 'üí•', tip: 'Save your ultimate for maximum impact in teamfights' },
                { icon: 'üîÆ', tip: 'Use your abilities to zone enemies from minion waves and control CS' },
                { icon: 'üìè', tip: 'Position for teamfights where you can land your abilities on multiple enemies' }
            ],
            'Support': [
                { icon: 'üëÅÔ∏è', tip: 'Ward key areas and deny enemy vision with control wards' },
                { icon: '&#129309;', tip: 'Roam to help other lanes when your ADC is safe' },
                { icon: '&#128737;', tip: 'Protect your carries and peel for them in teamfights' },
                { icon: 'üí°', tip: 'Build according to team needs - tank items or enchanter items' },
                { icon: '&#128065;', tip: 'Use your vision control to set up ganks and avoid enemy ganks' },
                { icon: '&#129309;', tip: 'Look for opportunities to create picks with your crowd control' }
            ]
        };

        // Get champion-specific pro tips
        function getChampionProTips(championName) {
            // First try exact match
            if (championProTips[championName]) {
                return championProTips[championName];
            }
            
            // Try normalized name (without special characters)
            const normalizedName = championName.replace(/[^a-zA-Z0-9]/g, '').toLowerCase();
            for (const key in championProTips) {
                const normalizedKey = key.replace(/[^a-zA-Z0-9]/g, '').toLowerCase();
                if (normalizedKey === normalizedName) {
                    return championProTips[key];
                }
            }
            
            // Fall back to role-based tips
            const champion = allChampions[championName];
            if (champion && championProTips[champion.role]) {
                return championProTips[champion.role];
            }
            
            // Final fallback to Fighter tips
            return championProTips['Fighter'] || [
                { icon: '‚öîÔ∏è', tip: 'Adapt your playstyle based on the enemy team composition' },
                { icon: 'üõ°Ô∏è', tip: 'Focus on farming safely and scaling into the late game' }
            ];
        }

function restartQuestionnaire() {
            answers = {};
            currentQuestion = 1;
            mlResults = {};
            
            document.getElementById('detailed-analysis').classList.remove('active');
            document.querySelectorAll('.question-card').forEach(card => {
                card.classList.remove('active');
            });
            
            document.getElementById('start-screen').style.display = 'block';
            
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            document.querySelectorAll('[id^="next-"]').forEach(btn => btn.disabled = true);
        }

        // Function to manually download user data (for admin use)
        function downloadUserData() {
            const userData = JSON.parse(localStorage.getItem('championRecommenderUsers') || '[]');
            if (userData.length > 0) {
                // Trigger download
                const csvContent = "Full Name,Email,Phone,Age,Gender,LoL Experience,Registration Date,Session ID,Recommended Champion,Winning Algorithm,Confidence Score,Random Forest Champion,Random Forest Confidence,Decision Tree Champion,Decision Tree Confidence,KNN Champion,KNN Confidence,Consensus Level,User Answers,Completion Date,Pressure Response,Aesthetic Preference,Team Contribution,Character Identity,Problem Solving Approach\n";
                let content = csvContent;
                
                userData.forEach(user => {
                    const row = [
                        user.fullName,
                        user.email,
                        user.phone,
                        user.age,
                        user.gender,
                        user.experience,
                        new Date(user.registrationDate).toLocaleString(),
                        user.sessionId,
                        user.recommendedChampion || '',
                        user.winningAlgorithm || '',
                        user.confidence || '',
                        user.randomForestChampion || '',
                        user.randomForestConfidence || '',
                        user.decisionTreeChampion || '',
                        user.decisionTreeConfidence || '',
                        user.knnChampion || '',
                        user.knnConfidence || '',
                        user.consensusLevel || '',
                        user.userAnswers || '',
                        user.completionDate || '',
                        user.pressureResponse || '',
                        user.aestheticPreference || '',
                        user.teamContribution || '',
                        user.characterIdentity || '',
                        user.problemSolving || ''
                    ].map(field => `"${field}"`).join(',');
                    
                    content += row + "\n";
                });
                
                const blob = new Blob([content], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'champion_recommender_users.csv';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            } else {
                alert('No user data available to download.');
            }
        }
        
        // Manual CSV export function
        function exportToCSV() {
            const userData = JSON.parse(localStorage.getItem('championRecommenderUsers') || '[]');
            if (userData.length === 0) {
                alert('No user data to export');
                return;
            }
            
            // Create CSV content
            const headers = [
                'ID', 'Full Name', 'Email', 'Phone', 'Age', 'Gender', 
                'LoL Experience', 'Registration Date', 'Session ID',
                'Recommended Champion', 'Winning Algorithm', 'Confidence Score',
                'Random Forest Champion', 'Random Forest Confidence',
                'Decision Tree Champion', 'Decision Tree Confidence',
                'KNN Champion', 'KNN Confidence', 'Consensus Level',
                'User Answers', 'Completion Date',
                'Pressure Response', 'Aesthetic Preference', 'Team Contribution',
                'Character Identity', 'Problem Solving Approach'
            ];
            
            let csvContent = headers.join(',') + '\n';
            
            userData.forEach((user, index) => {
                const row = [
                    index + 1,
                    user.fullName || '',
                    user.email || '',
                    user.phone || '',
                    user.age || '',
                    user.gender || '',
                    user.experience || '',
                    user.registrationDate || '',
                    user.sessionId || '',
                    user.recommendedChampion || '',
                    user.winningAlgorithm || '',
                    user.confidence || '',
                    user.randomForestChampion || '',
                    user.randomForestConfidence || '',
                    user.decisionTreeChampion || '',
                    user.decisionTreeConfidence || '',
                    user.knnChampion || '',
                    user.knnConfidence || '',
                    user.consensusLevel || '',
                    user.userAnswers || '',
                    user.completionDate || '',
                    user.pressureResponse || '',
                    user.aestheticPreference || '',
                    user.teamContribution || '',
                    user.characterIdentity || '',
                    user.problemSolving || ''
                ].map(field => '"' + field + '"');
                
                csvContent += row.join(',') + '\n';
            });
            
            // Download CSV
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', 'champion_recommender_users.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            console.log(`üìä Exported ${userData.length} users to CSV file`);
            alert(`Successfully exported ${userData.length} users to CSV file!`);
        }
        
        // Keyboard shortcut for manual export
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.shiftKey && e.key === 'E') {
                e.preventDefault();
                exportToCSV();
            }
        });

        console.log(`Multi-ML Champion Recommender loaded with ${Object.keys(allChampions).length} champions and 3 ML algorithms!`);

        // Admin panel (hidden) - Press Ctrl+Shift+A to access
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                showEnhancedAdminPanel();
            }
        });

        function showAdminPanel() {
            const userData = JSON.parse(localStorage.getItem('championRecommenderUsers') || '[]');
            const userCount = userData.length;
            
            const message = `Admin Panel

Total registered users: ${userCount}

Options:
- OK: Export CSV file
- Cancel: Close panel

Note: Data is stored locally. Press Ctrl+Shift+E anytime to export CSV.`;
            
            if (confirm(message)) {
                exportToCSV();
            }
        }

        // Enhanced admin panel with Supabase data
        async function showEnhancedAdminPanel() {
            const userData = JSON.parse(localStorage.getItem('championRecommenderUsers') || '[]');
            const userCount = userData.length;
            
            let supabaseInfo = '';
            try {
                // Dynamically import Supabase client
                const { getUserCount } = await import('./js/supabase.js');
                
                if (getUserCount) {
                    // Try to fetch Supabase data
                    const supabaseUsers = await getUserCount();
                    if (supabaseUsers.success) {
                        supabaseInfo = `
Supabase users: ${supabaseUsers.count}
Supabase data available for viewing.`;
                    } else {
                        supabaseInfo = 'Supabase connection established but unable to fetch data.';
                    }
                } else {
                    supabaseInfo = 'Supabase not configured.';
                }
            } catch (error) {
                supabaseInfo = 'Supabase not available or not configured.';
            }
            
            const message = `Enhanced Admin Panel

Local storage users: ${userCount}
${supabaseInfo}

Options:
- OK: Export CSV file
- Cancel: Close panel

Note: Press Ctrl+Shift+E to export CSV.`;
            
            if (confirm(message)) {
                exportToCSV();
            }
        }

        // Auto-save user data periodically
        setInterval(() => {
            const userData = JSON.parse(localStorage.getItem('championRecommenderUsers') || '[]');
            if (userData.length > 0) {
                console.log(userData.length + ' users registered so far');
            }
        }, 60000); // Check every minute
    </script>
    <script>
        // Vercel Analytics
        (function() {
            if (typeof window !== 'undefined') {
                fetch('https://vitals.vercel-insights.com/v1/vitals', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        dsn: 'https://vitals.vercel-insights.com/v1/vitals',
                        id: window.location.hostname,
                        page: window.location.pathname + window.location.search,
                        href: window.location.href
                    })
                }).catch(function() {});
            }
        })();
    </script>
    
    <!-- Supabase Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // Initialize Supabase client
        const supabaseUrl = 'https://brshmbbohqcdseyirqsn.supabase.co';
        const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJyc2htYmJvaHFjZHNleWlycXNuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEwOTYyNzAsImV4cCI6MjA3NjY3MjI3MH0.Yi-aWEuvArux0qRrEgnnzIljrsh5NnVBOxHlpBqbn2E';
        const supabase = supabase.createClient(supabaseUrl, supabaseAnonKey);
        
        // Function to save user data to Supabase
        async function saveToSupabase() {
            try {
                // Generate a unique session ID
                const sessionId = 'session_' + Date.now() + '_' + Math.floor(Math.random() * 1000);
                
                // Get the recommended champion from the analysis
                const winner = findWinner(mlResults);
                const recommendedChampion = mlResults[winner].champion;
                
                // First, create a minimal user entry
                const userData = {
                    full_name: 'Anonymous User',
                    email: '',
                    phone: '',
                    age: null,
                    gender: '',
                    experience: '',
                    registration_date: new Date().toISOString(),
                    session_id: sessionId
                };
                
                // Insert user data into Supabase
                const { data: userResult, error: userError } = await supabase
                    .from('users')
                    .insert([userData])
                    .select();
                
                if (userError) {
                    console.error('Error saving user to Supabase:', userError);
                    alert('Error saving user data: ' + userError.message);
                    return;
                }
                
                // Create the questionnaire results data object
                const questionnaireData = {
                    session_id: sessionId,
                    recommended_champion: recommendedChampion,
                    winning_algorithm: winner,
                    confidence_score: mlResults[winner].confidence,
                    random_forest_champion: mlResults['random-forest'] ? mlResults['random-forest'].champion : '',
                    random_forest_confidence: mlResults['random-forest'] ? mlResults['random-forest'].confidence : null,
                    decision_tree_champion: mlResults['decision-tree'] ? mlResults['decision-tree'].champion : '',
                    decision_tree_confidence: mlResults['decision-tree'] ? mlResults['decision-tree'].confidence : null,
                    knn_champion: mlResults['knn'] ? mlResults['knn'].champion : '',
                    knn_confidence: mlResults['knn'] ? mlResults['knn'].confidence : null,
                    user_answers: JSON.stringify(answers),
                    completion_date: new Date().toISOString(),
                    // Psychological questions mapping (if available)
                    pressure_response: answers[6] || null,
                    aesthetic_preference: answers[7] || null,
                    team_contribution: answers[8] || null,
                    character_identity: answers[9] || null,
                    problem_solving: answers[10] || null
                };
                
                // Insert questionnaire results into Supabase
                const { data: result, error } = await supabase
                    .from('questionnaire_results')
                    .insert([questionnaireData])
                    .select();
                
                if (error) {
                    console.error('Error saving questionnaire results to Supabase:', error);
                    alert('Error saving questionnaire results: ' + error.message);
                } else {
                    console.log('Data saved successfully:', result);
                    alert('Data saved to database successfully!');
                }
            } catch (error) {
                console.error('Error saving to Supabase:', error);
                alert('Error saving to database: ' + error.message);
            }
        }
    </script>
</body>
</html>
